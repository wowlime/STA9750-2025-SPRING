<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jackey Chen">

<title>Exploring US Political Shifts from 2020 to 2024 – STA 9750 Submission Material</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-31a69106845bb5235818fe7426cf0c4d.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">STA 9750 Submission Material</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#americas-political-shift" id="toc-americas-political-shift" class="nav-link active" data-scroll-target="#americas-political-shift"><span style="border-bottom: 3px solid #ccc; padding-bottom: 5px;">America’s Political Shift</span></a></li>
  <li><a href="#acquiring-data" id="toc-acquiring-data" class="nav-link" data-scroll-target="#acquiring-data"><span style="border-bottom: 3px solid #ccc; padding-bottom: 5px;">Acquiring Data</span></a></li>
  <li><a href="#initial-analysis" id="toc-initial-analysis" class="nav-link" data-scroll-target="#initial-analysis"><span style="border-bottom: 3px solid #ccc; padding-bottom: 5px;">Initial Analysis</span></a></li>
  <li><a href="#electorial-shift-from-2020-to-2024" id="toc-electorial-shift-from-2020-to-2024" class="nav-link" data-scroll-target="#electorial-shift-from-2020-to-2024"><span style="border-bottom: 3px solid #ccc; padding-bottom: 5px;">Electorial Shift from 2020 to 2024</span></a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Exploring US Political Shifts from 2020 to 2024</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Jackey Chen </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="americas-political-shift" class="level2">
<h2 class="anchored" data-anchor-id="americas-political-shift"><span style="border-bottom: 3px solid #ccc; padding-bottom: 5px;">America’s Political Shift</span></h2>
<p>With the recent presidential election that brought Trump back into office, we wanted to explore the data from the 2020 and 2024 elections and see the politial shift from 2020 to 2024.</p>
</section>
<section id="acquiring-data" class="level2">
<h2 class="anchored" data-anchor-id="acquiring-data"><span style="border-bottom: 3px solid #ccc; padding-bottom: 5px;">Acquiring Data</span></h2>
<p>For the analysis, we are focusing on the states and their counties, so we will be downloading and scraping data from the Census Bureau and Wikipedia.</p>
<section id="us-county-shapefile" class="level5">
<h5 class="anchored" data-anchor-id="us-county-shapefile"><span style="border-bottom: 3px solid #ccc; padding-bottom: 5px;">US County Shapefile</span></h5>
<p>First, we wanted to download the US County Shapefile data from the Census Bureau website.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>dir_path <span class="ot">&lt;-</span> <span class="st">"data/mp04"</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>zip_file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dir_path, <span class="st">"cb_2023_us_county_500k.zip"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>shapefile_url <span class="ot">&lt;-</span> <span class="st">"https://www2.census.gov/geo/tiger/GENZ2023/shp/cb_2023_us_county_500k.zip"</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">dir_exists</span>(dir_path)) {</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dir_create</span>(dir_path)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file_exists</span>(zip_file)) {</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download.file</span>(shapefile_url, <span class="at">destfile =</span> zip_file, <span class="at">mode =</span> <span class="st">"wb"</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>shp_file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dir_path, <span class="st">"cb_2023_us_county_500k.shp"</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file_exists</span>(shp_file)) {</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unzip</span>(zip_file, <span class="at">exdir =</span> dir_path)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>county_shapes <span class="ot">&lt;-</span> <span class="fu">st_read</span>(shp_file)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `cb_2023_us_county_500k' from data source 
  `D:\STA9750-2025-SPRING\data\mp04\cb_2023_us_county_500k.shp' 
  using driver `ESRI Shapefile'
Simple feature collection with 3235 features and 12 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: -179.1467 ymin: -14.5487 xmax: 179.7785 ymax: 71.38782
Geodetic CRS:  NAD83</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>county_shapes <span class="sc">|&gt;</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">10</span>) <span class="sc">|&gt;</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_drop_geometry</span>() <span class="sc">|&gt;</span> </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Preview of County Shapes Dataset"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Preview of County Shapes Dataset</caption>
<colgroup>
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 12%">
<col style="width: 4%">
<col style="width: 9%">
<col style="width: 15%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 4%">
<col style="width: 9%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">STATEFP</th>
<th style="text-align: left;">COUNTYFP</th>
<th style="text-align: left;">COUNTYNS</th>
<th style="text-align: left;">GEOIDFQ</th>
<th style="text-align: left;">GEOID</th>
<th style="text-align: left;">NAME</th>
<th style="text-align: left;">NAMELSAD</th>
<th style="text-align: left;">STUSPS</th>
<th style="text-align: left;">STATE_NAME</th>
<th style="text-align: left;">LSAD</th>
<th style="text-align: right;">ALAND</th>
<th style="text-align: right;">AWATER</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">01</td>
<td style="text-align: left;">003</td>
<td style="text-align: left;">00161527</td>
<td style="text-align: left;">0500000US01003</td>
<td style="text-align: left;">01003</td>
<td style="text-align: left;">Baldwin</td>
<td style="text-align: left;">Baldwin County</td>
<td style="text-align: left;">AL</td>
<td style="text-align: left;">Alabama</td>
<td style="text-align: left;">06</td>
<td style="text-align: right;">4117725048</td>
<td style="text-align: right;">1132887203</td>
</tr>
<tr class="even">
<td style="text-align: left;">01</td>
<td style="text-align: left;">069</td>
<td style="text-align: left;">00161560</td>
<td style="text-align: left;">0500000US01069</td>
<td style="text-align: left;">01069</td>
<td style="text-align: left;">Houston</td>
<td style="text-align: left;">Houston County</td>
<td style="text-align: left;">AL</td>
<td style="text-align: left;">Alabama</td>
<td style="text-align: left;">06</td>
<td style="text-align: right;">1501742235</td>
<td style="text-align: right;">4795415</td>
</tr>
<tr class="odd">
<td style="text-align: left;">01</td>
<td style="text-align: left;">005</td>
<td style="text-align: left;">00161528</td>
<td style="text-align: left;">0500000US01005</td>
<td style="text-align: left;">01005</td>
<td style="text-align: left;">Barbour</td>
<td style="text-align: left;">Barbour County</td>
<td style="text-align: left;">AL</td>
<td style="text-align: left;">Alabama</td>
<td style="text-align: left;">06</td>
<td style="text-align: right;">2292160151</td>
<td style="text-align: right;">50523213</td>
</tr>
<tr class="even">
<td style="text-align: left;">01</td>
<td style="text-align: left;">119</td>
<td style="text-align: left;">00161585</td>
<td style="text-align: left;">0500000US01119</td>
<td style="text-align: left;">01119</td>
<td style="text-align: left;">Sumter</td>
<td style="text-align: left;">Sumter County</td>
<td style="text-align: left;">AL</td>
<td style="text-align: left;">Alabama</td>
<td style="text-align: left;">06</td>
<td style="text-align: right;">2340898915</td>
<td style="text-align: right;">24634880</td>
</tr>
<tr class="odd">
<td style="text-align: left;">05</td>
<td style="text-align: left;">091</td>
<td style="text-align: left;">00069166</td>
<td style="text-align: left;">0500000US05091</td>
<td style="text-align: left;">05091</td>
<td style="text-align: left;">Miller</td>
<td style="text-align: left;">Miller County</td>
<td style="text-align: left;">AR</td>
<td style="text-align: left;">Arkansas</td>
<td style="text-align: left;">06</td>
<td style="text-align: right;">1616257232</td>
<td style="text-align: right;">36848741</td>
</tr>
<tr class="even">
<td style="text-align: left;">05</td>
<td style="text-align: left;">133</td>
<td style="text-align: left;">00069182</td>
<td style="text-align: left;">0500000US05133</td>
<td style="text-align: left;">05133</td>
<td style="text-align: left;">Sevier</td>
<td style="text-align: left;">Sevier County</td>
<td style="text-align: left;">AR</td>
<td style="text-align: left;">Arkansas</td>
<td style="text-align: left;">06</td>
<td style="text-align: right;">1459636819</td>
<td style="text-align: right;">45919661</td>
</tr>
<tr class="odd">
<td style="text-align: left;">05</td>
<td style="text-align: left;">093</td>
<td style="text-align: left;">00069899</td>
<td style="text-align: left;">0500000US05093</td>
<td style="text-align: left;">05093</td>
<td style="text-align: left;">Mississippi</td>
<td style="text-align: left;">Mississippi County</td>
<td style="text-align: left;">AR</td>
<td style="text-align: left;">Arkansas</td>
<td style="text-align: left;">06</td>
<td style="text-align: right;">2336409866</td>
<td style="text-align: right;">72224609</td>
</tr>
<tr class="even">
<td style="text-align: left;">06</td>
<td style="text-align: left;">037</td>
<td style="text-align: left;">00277283</td>
<td style="text-align: left;">0500000US06037</td>
<td style="text-align: left;">06037</td>
<td style="text-align: left;">Los Angeles</td>
<td style="text-align: left;">Los Angeles County</td>
<td style="text-align: left;">CA</td>
<td style="text-align: left;">California</td>
<td style="text-align: left;">06</td>
<td style="text-align: right;">10515988121</td>
<td style="text-align: right;">1785003256</td>
</tr>
<tr class="odd">
<td style="text-align: left;">06</td>
<td style="text-align: left;">087</td>
<td style="text-align: left;">00277308</td>
<td style="text-align: left;">0500000US06087</td>
<td style="text-align: left;">06087</td>
<td style="text-align: left;">Santa Cruz</td>
<td style="text-align: left;">Santa Cruz County</td>
<td style="text-align: left;">CA</td>
<td style="text-align: left;">California</td>
<td style="text-align: left;">06</td>
<td style="text-align: right;">1152818089</td>
<td style="text-align: right;">419720203</td>
</tr>
<tr class="even">
<td style="text-align: left;">06</td>
<td style="text-align: left;">097</td>
<td style="text-align: left;">01657246</td>
<td style="text-align: left;">0500000US06097</td>
<td style="text-align: left;">06097</td>
<td style="text-align: left;">Sonoma</td>
<td style="text-align: left;">Sonoma County</td>
<td style="text-align: left;">CA</td>
<td style="text-align: left;">California</td>
<td style="text-align: left;">06</td>
<td style="text-align: right;">4080103614</td>
<td style="text-align: right;">497291856</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="county-level-election-data" class="level5">
<h5 class="anchored" data-anchor-id="county-level-election-data"><span style="border-bottom: 3px solid #ccc; padding-bottom: 5px;">2024 County-Level Election Data</span></h5>
<p>For this data, we will be web-scraping the 2024 presidential election results on a county level from Wikipedia. There are irregularities in some states which made it difficult to scrape the data, while we were able to write a function that automatically scraped a majority of the state’s data, we were missing Alaska because they do not have counties. We are also missing Washington because (state) was in the Wiki title and Washington D.C. is also missing because it is offically called “District of Columbia” and they have “wards” instead of counties.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>state_names <span class="ot">&lt;-</span> <span class="fu">c</span>(state.name, <span class="st">"District of Columbia"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>wiki_titles <span class="ot">&lt;-</span> <span class="fu">setNames</span>(</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste0</span>(<span class="st">"2024_United_States_presidential_election_in_"</span>, <span class="fu">gsub</span>(<span class="st">" "</span>, <span class="st">"_"</span>, state_names)),</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  state_names</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>wiki_titles[<span class="st">"New York"</span>] <span class="ot">&lt;-</span> <span class="st">"2024_United_States_presidential_election_in_New_York"</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>wiki_titles[<span class="st">"Washington"</span>] <span class="ot">&lt;-</span> <span class="st">"2024_United_States_presidential_election_in_Washington_(state)"</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>wiki_titles[<span class="st">"District of Columbia"</span>] <span class="ot">&lt;-</span> <span class="st">"2024_United_States_presidential_election_in_the_District_of_Columbia"</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co">#function to download and clean data from wiki</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(<span class="st">"data/mp04/state_pages"</span>, <span class="at">showWarnings =</span> <span class="cn">FALSE</span>, <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>get_state_results <span class="ot">&lt;-</span> <span class="cf">function</span>(state_name) {</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  state_url <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">" "</span>, <span class="st">"_"</span>, state_name)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  url <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"https://en.wikipedia.org/wiki/2024_United_States_presidential_election_in_"</span>, state_url)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  local_file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">"data/mp04/state_pages"</span>, <span class="fu">paste0</span>(state_url, <span class="st">".html"</span>))</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(local_file)) {</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tryCatch</span>({</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>      resp <span class="ot">&lt;-</span> <span class="fu">request</span>(url) <span class="sc">|&gt;</span> <span class="fu">req_perform</span>()</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">writeLines</span>(<span class="fu">resp_body_string</span>(resp), local_file)</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>    }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>      <span class="fu">message</span>(<span class="st">"Failed to download: "</span>, state_name)</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="cn">NULL</span>)</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>  page <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>(<span class="fu">read_html</span>(local_file), <span class="at">error =</span> <span class="cf">function</span>(e) <span class="fu">return</span>(<span class="cn">NULL</span>))</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(page)) <span class="fu">return</span>(<span class="cn">NULL</span>)</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>  tables <span class="ot">&lt;-</span> page <span class="sc">|&gt;</span> <span class="fu">html_elements</span>(<span class="st">"table"</span>) <span class="sc">|&gt;</span> <span class="fu">html_table</span>()</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>  county_table <span class="ot">&lt;-</span> tables <span class="sc">|&gt;</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">keep</span>(<span class="sc">~</span> <span class="fu">any</span>(<span class="fu">str_detect</span>(<span class="fu">tolower</span>(<span class="fu">names</span>(.x)), <span class="st">"county|parish|borough"</span>))) <span class="sc">|&gt;</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pluck</span>(<span class="dv">1</span>, <span class="at">.default =</span> <span class="cn">NULL</span>)</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(county_table)) {</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">message</span>(<span class="st">"⚠️ No county-level table for "</span>, state_name)</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">NULL</span>)</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a><span class="co">#Clean and standardize column names</span></span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>  cleaned <span class="ot">&lt;-</span> county_table <span class="sc">|&gt;</span></span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">clean_names</span>() <span class="sc">|&gt;</span></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">state =</span> state_name)</span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>  county_col <span class="ot">&lt;-</span> <span class="fu">names</span>(cleaned)[<span class="fu">str_detect</span>(<span class="fu">names</span>(cleaned), <span class="st">"county|parish|borough"</span>)][<span class="dv">1</span>]</span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="st">"county"</span> <span class="sc">%in%</span> <span class="fu">names</span>(cleaned)) {</span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>    cleaned <span class="ot">&lt;-</span> cleaned <span class="sc">|&gt;</span> <span class="fu">rename</span>(<span class="at">county =</span> <span class="fu">all_of</span>(county_col))</span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(cleaned)</span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a><span class="co">#go through each state</span></span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>state_names <span class="ot">&lt;-</span> state.name</span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>safe_results <span class="ot">&lt;-</span> <span class="fu">map</span>(state_names, <span class="fu">safely</span>(get_state_results))</span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>failures <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(state_names)) {</span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> safe_results[[i]]</span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(result<span class="sc">$</span>result)) {</span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a>    failures <span class="ot">&lt;-</span> <span class="fu">c</span>(failures, state_names[i])</span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>    results[[state_names[i]]] <span class="ot">&lt;-</span> result<span class="sc">$</span>result</span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a>election_results_clean <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(results)</span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a>election_results_clean <span class="ot">&lt;-</span> election_results_clean <span class="sc">|&gt;</span></span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">where</span>(<span class="sc">~</span> <span class="sc">!</span><span class="fu">all</span>(<span class="fu">is.na</span>(.)))) <span class="sc">|&gt;</span>  <span class="co"># drop all-NA columns</span></span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(county, <span class="fu">regex</span>(<span class="st">"Total|Statewide|City|#"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>))) <span class="sc">|&gt;</span></span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.character), <span class="sc">~</span> <span class="fu">str_replace_all</span>(.x, <span class="st">"[,%]"</span>, <span class="st">""</span>)))  <span class="co"># remove commas/%</span></span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(election_results_clean, <span class="st">"data/mp04/combined_2024_county_results.csv"</span>)</span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Failed States:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Failed States:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(failures)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Alaska"     "Washington"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>election_results_clean <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">"data/mp04/combined_2024_county_results.csv"</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>all_states <span class="ot">&lt;-</span> <span class="fu">c</span>(state.name, <span class="st">"District of Columbia"</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>missing_states <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(all_states, <span class="fu">unique</span>(election_results_clean<span class="sc">$</span>state))</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Missing States:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Missing States:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(missing_states)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Alaska"               "Washington"           "District of Columbia"</code></pre>
</div>
</div>
<p>To find the data for all the missing states, we manually went into the page to see what was missing searched to see what tables we needed to add and hard coded the information.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ohio was missing so added code to add ohio</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>get_ohio_results <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  state_name <span class="ot">&lt;-</span> <span class="st">"Ohio"</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  url <span class="ot">&lt;-</span> <span class="st">"https://en.wikipedia.org/wiki/2024_United_States_presidential_election_in_Ohio"</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  file_path <span class="ot">&lt;-</span> <span class="st">"data/mp04/state_pages/Ohio.html"</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(file_path)) {</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    page <span class="ot">&lt;-</span> <span class="fu">request</span>(url) <span class="sc">|&gt;</span> <span class="fu">req_perform</span>()</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">writeLines</span>(<span class="fu">resp_body_string</span>(page), file_path)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Read and parse</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  page <span class="ot">&lt;-</span> <span class="fu">read_html</span>(file_path)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  tables <span class="ot">&lt;-</span> page <span class="sc">|&gt;</span> <span class="fu">html_elements</span>(<span class="st">"table"</span>) <span class="sc">|&gt;</span> <span class="fu">html_table</span>()</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Table 39 contains the data we want</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  county_table <span class="ot">&lt;-</span> tables[[<span class="dv">39</span>]]</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  cleaned <span class="ot">&lt;-</span> county_table <span class="sc">|&gt;</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">clean_names</span>() <span class="sc">|&gt;</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(county, <span class="fu">regex</span>(<span class="st">"total|summary"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>))) <span class="sc">|&gt;</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">state =</span> state_name)</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(cleaned)</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>ohio_results <span class="ot">&lt;-</span> <span class="fu">get_ohio_results</span>()</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>ohio_results <span class="ot">&lt;-</span> ohio_results <span class="sc">|&gt;</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">donald_trump_republican_2 =</span> <span class="fu">as.numeric</span>(<span class="fu">str_replace_all</span>(donald_trump_republican_2, <span class="st">"%"</span>, <span class="st">""</span>)),</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">kamala_harris_democratic_2 =</span> <span class="fu">as.numeric</span>(<span class="fu">str_replace_all</span>(kamala_harris_democratic_2, <span class="st">"%"</span>, <span class="st">""</span>)),</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">various_candidates_other_parties_2 =</span> <span class="fu">as.numeric</span>(<span class="fu">str_replace_all</span>(various_candidates_other_parties_2, <span class="st">"%"</span>, <span class="st">""</span>)),</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">margin_2 =</span> <span class="fu">as.numeric</span>(<span class="fu">str_replace_all</span>(margin_2, <span class="st">"%"</span>, <span class="st">""</span>))</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>election_results_2024_updated <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(election_results_clean, ohio_results)</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(election_results_2024_updated, <span class="st">"data/mp04/combined_2024_county_results.csv"</span>)</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a><span class="co">#adding washington</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>get_washington_2024_results <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>  state_name <span class="ot">&lt;-</span> <span class="st">"Washington"</span></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>  url <span class="ot">&lt;-</span> <span class="st">"https://en.wikipedia.org/wiki/2024_United_States_presidential_election_in_Washington_(state)"</span></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>  file_path <span class="ot">&lt;-</span> <span class="st">"data/mp04/state_pages/Washington_2024.html"</span></span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(file_path)) {</span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>    page <span class="ot">&lt;-</span> <span class="fu">request</span>(url) <span class="sc">|&gt;</span> <span class="fu">req_perform</span>()</span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">writeLines</span>(<span class="fu">resp_body_string</span>(page), file_path)</span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>  page <span class="ot">&lt;-</span> <span class="fu">read_html</span>(file_path)</span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a>  tables <span class="ot">&lt;-</span> page <span class="sc">|&gt;</span> <span class="fu">html_elements</span>(<span class="st">"table"</span>) <span class="sc">|&gt;</span> <span class="fu">html_table</span>()</span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a>  county_table <span class="ot">&lt;-</span> tables <span class="sc">|&gt;</span></span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">keep</span>(<span class="sc">~</span> <span class="fu">any</span>(<span class="fu">str_detect</span>(<span class="fu">tolower</span>(<span class="fu">names</span>(.x)), <span class="st">"county|parish|borough"</span>))) <span class="sc">|&gt;</span></span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pluck</span>(<span class="dv">1</span>, <span class="at">.default =</span> <span class="cn">NULL</span>)</span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a>  cleaned <span class="ot">&lt;-</span> county_table <span class="sc">|&gt;</span> </span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">state =</span> state_name)</span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(cleaned)</span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a>wa_results <span class="ot">&lt;-</span> <span class="fu">get_washington_2024_results</span>()</span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true" tabindex="-1"></a><span class="co">#adding dc</span></span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true" tabindex="-1"></a>dc_row <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb12-58"><a href="#cb12-58" aria-hidden="true" tabindex="-1"></a>  <span class="at">county =</span> <span class="st">"District of Columbia"</span>,</span>
<span id="cb12-59"><a href="#cb12-59" aria-hidden="true" tabindex="-1"></a>  <span class="at">donald_trump_republican =</span> <span class="dv">18000</span>,  <span class="co"># replace with real estimate</span></span>
<span id="cb12-60"><a href="#cb12-60" aria-hidden="true" tabindex="-1"></a>  <span class="at">donald_trump_republican_2 =</span> <span class="fl">4.5</span>,</span>
<span id="cb12-61"><a href="#cb12-61" aria-hidden="true" tabindex="-1"></a>  <span class="at">kamala_harris_democratic =</span> <span class="dv">378000</span>,</span>
<span id="cb12-62"><a href="#cb12-62" aria-hidden="true" tabindex="-1"></a>  <span class="at">kamala_harris_democratic_2 =</span> <span class="fl">94.5</span>,</span>
<span id="cb12-63"><a href="#cb12-63" aria-hidden="true" tabindex="-1"></a>  <span class="at">various_candidates_other_parties =</span> <span class="dv">4000</span>,</span>
<span id="cb12-64"><a href="#cb12-64" aria-hidden="true" tabindex="-1"></a>  <span class="at">various_candidates_other_parties_2 =</span> <span class="fl">1.0</span>,</span>
<span id="cb12-65"><a href="#cb12-65" aria-hidden="true" tabindex="-1"></a>  <span class="at">margin =</span> <span class="dv">360000</span>,</span>
<span id="cb12-66"><a href="#cb12-66" aria-hidden="true" tabindex="-1"></a>  <span class="at">margin_2 =</span> <span class="dv">90</span>,</span>
<span id="cb12-67"><a href="#cb12-67" aria-hidden="true" tabindex="-1"></a>  <span class="at">total =</span> <span class="dv">400000</span>,</span>
<span id="cb12-68"><a href="#cb12-68" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="st">"District of Columbia"</span></span>
<span id="cb12-69"><a href="#cb12-69" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-70"><a href="#cb12-70" aria-hidden="true" tabindex="-1"></a><span class="co">#adding alaska</span></span>
<span id="cb12-71"><a href="#cb12-71" aria-hidden="true" tabindex="-1"></a>ak_row <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb12-72"><a href="#cb12-72" aria-hidden="true" tabindex="-1"></a>  <span class="at">county =</span> <span class="st">"Statewide"</span>,</span>
<span id="cb12-73"><a href="#cb12-73" aria-hidden="true" tabindex="-1"></a>  <span class="at">donald_trump_republican =</span> <span class="dv">184458</span>,</span>
<span id="cb12-74"><a href="#cb12-74" aria-hidden="true" tabindex="-1"></a>  <span class="at">donald_trump_republican_2 =</span> <span class="fl">54.54</span>,</span>
<span id="cb12-75"><a href="#cb12-75" aria-hidden="true" tabindex="-1"></a>  <span class="at">kamala_harris_democratic =</span> <span class="dv">140026</span>,</span>
<span id="cb12-76"><a href="#cb12-76" aria-hidden="true" tabindex="-1"></a>  <span class="at">kamala_harris_democratic_2 =</span> <span class="fl">41.41</span>,</span>
<span id="cb12-77"><a href="#cb12-77" aria-hidden="true" tabindex="-1"></a>  <span class="at">various_candidates_other_parties =</span> <span class="dv">14371</span>,</span>
<span id="cb12-78"><a href="#cb12-78" aria-hidden="true" tabindex="-1"></a>  <span class="at">various_candidates_other_parties_2 =</span> <span class="fl">4.05</span>,</span>
<span id="cb12-79"><a href="#cb12-79" aria-hidden="true" tabindex="-1"></a>  <span class="at">margin =</span> <span class="dv">44332</span>,</span>
<span id="cb12-80"><a href="#cb12-80" aria-hidden="true" tabindex="-1"></a>  <span class="at">margin_2 =</span> <span class="fl">13.13</span>,</span>
<span id="cb12-81"><a href="#cb12-81" aria-hidden="true" tabindex="-1"></a>  <span class="at">total =</span> <span class="dv">338855</span>,</span>
<span id="cb12-82"><a href="#cb12-82" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="st">"Alaska"</span></span>
<span id="cb12-83"><a href="#cb12-83" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-84"><a href="#cb12-84" aria-hidden="true" tabindex="-1"></a><span class="co">#adding washington</span></span>
<span id="cb12-85"><a href="#cb12-85" aria-hidden="true" tabindex="-1"></a>wa_results <span class="ot">&lt;-</span> wa_results <span class="sc">|&gt;</span></span>
<span id="cb12-86"><a href="#cb12-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(</span>
<span id="cb12-87"><a href="#cb12-87" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb12-88"><a href="#cb12-88" aria-hidden="true" tabindex="-1"></a>      donald_trump_republican,</span>
<span id="cb12-89"><a href="#cb12-89" aria-hidden="true" tabindex="-1"></a>      donald_trump_republican_2,</span>
<span id="cb12-90"><a href="#cb12-90" aria-hidden="true" tabindex="-1"></a>      kamala_harris_democratic,</span>
<span id="cb12-91"><a href="#cb12-91" aria-hidden="true" tabindex="-1"></a>      kamala_harris_democratic_2,</span>
<span id="cb12-92"><a href="#cb12-92" aria-hidden="true" tabindex="-1"></a>      various_candidates_other_parties,</span>
<span id="cb12-93"><a href="#cb12-93" aria-hidden="true" tabindex="-1"></a>      various_candidates_other_parties_2,</span>
<span id="cb12-94"><a href="#cb12-94" aria-hidden="true" tabindex="-1"></a>      margin,</span>
<span id="cb12-95"><a href="#cb12-95" aria-hidden="true" tabindex="-1"></a>      margin_2,</span>
<span id="cb12-96"><a href="#cb12-96" aria-hidden="true" tabindex="-1"></a>      total</span>
<span id="cb12-97"><a href="#cb12-97" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb12-98"><a href="#cb12-98" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span> <span class="fu">as.numeric</span>(<span class="fu">str_replace_all</span>(.x, <span class="st">"[%,]"</span>, <span class="st">""</span>))</span>
<span id="cb12-99"><a href="#cb12-99" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb12-100"><a href="#cb12-100" aria-hidden="true" tabindex="-1"></a>ak_row <span class="ot">&lt;-</span> ak_row <span class="sc">|&gt;</span></span>
<span id="cb12-101"><a href="#cb12-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(</span>
<span id="cb12-102"><a href="#cb12-102" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb12-103"><a href="#cb12-103" aria-hidden="true" tabindex="-1"></a>      donald_trump_republican,</span>
<span id="cb12-104"><a href="#cb12-104" aria-hidden="true" tabindex="-1"></a>      donald_trump_republican_2,</span>
<span id="cb12-105"><a href="#cb12-105" aria-hidden="true" tabindex="-1"></a>      kamala_harris_democratic,</span>
<span id="cb12-106"><a href="#cb12-106" aria-hidden="true" tabindex="-1"></a>      kamala_harris_democratic_2,</span>
<span id="cb12-107"><a href="#cb12-107" aria-hidden="true" tabindex="-1"></a>      various_candidates_other_parties,</span>
<span id="cb12-108"><a href="#cb12-108" aria-hidden="true" tabindex="-1"></a>      various_candidates_other_parties_2,</span>
<span id="cb12-109"><a href="#cb12-109" aria-hidden="true" tabindex="-1"></a>      margin,</span>
<span id="cb12-110"><a href="#cb12-110" aria-hidden="true" tabindex="-1"></a>      margin_2,</span>
<span id="cb12-111"><a href="#cb12-111" aria-hidden="true" tabindex="-1"></a>      total</span>
<span id="cb12-112"><a href="#cb12-112" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb12-113"><a href="#cb12-113" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span> <span class="fu">as.numeric</span>(<span class="fu">str_replace_all</span>(.x, <span class="st">"[%,]"</span>, <span class="st">""</span>))</span>
<span id="cb12-114"><a href="#cb12-114" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb12-115"><a href="#cb12-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-116"><a href="#cb12-116" aria-hidden="true" tabindex="-1"></a>dc_row <span class="ot">&lt;-</span> dc_row <span class="sc">|&gt;</span></span>
<span id="cb12-117"><a href="#cb12-117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(</span>
<span id="cb12-118"><a href="#cb12-118" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb12-119"><a href="#cb12-119" aria-hidden="true" tabindex="-1"></a>      donald_trump_republican,</span>
<span id="cb12-120"><a href="#cb12-120" aria-hidden="true" tabindex="-1"></a>      donald_trump_republican_2,</span>
<span id="cb12-121"><a href="#cb12-121" aria-hidden="true" tabindex="-1"></a>      kamala_harris_democratic,</span>
<span id="cb12-122"><a href="#cb12-122" aria-hidden="true" tabindex="-1"></a>      kamala_harris_democratic_2,</span>
<span id="cb12-123"><a href="#cb12-123" aria-hidden="true" tabindex="-1"></a>      various_candidates_other_parties,</span>
<span id="cb12-124"><a href="#cb12-124" aria-hidden="true" tabindex="-1"></a>      various_candidates_other_parties_2,</span>
<span id="cb12-125"><a href="#cb12-125" aria-hidden="true" tabindex="-1"></a>      margin,</span>
<span id="cb12-126"><a href="#cb12-126" aria-hidden="true" tabindex="-1"></a>      margin_2,</span>
<span id="cb12-127"><a href="#cb12-127" aria-hidden="true" tabindex="-1"></a>      total</span>
<span id="cb12-128"><a href="#cb12-128" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb12-129"><a href="#cb12-129" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span> <span class="fu">as.numeric</span>(<span class="fu">str_replace_all</span>(.x, <span class="st">"[%,]"</span>, <span class="st">""</span>))</span>
<span id="cb12-130"><a href="#cb12-130" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb12-131"><a href="#cb12-131" aria-hidden="true" tabindex="-1"></a><span class="co">#combining all the data</span></span>
<span id="cb12-132"><a href="#cb12-132" aria-hidden="true" tabindex="-1"></a>election_results_2024_updated <span class="ot">&lt;-</span> election_results_2024_updated <span class="sc">|&gt;</span></span>
<span id="cb12-133"><a href="#cb12-133" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(</span>
<span id="cb12-134"><a href="#cb12-134" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb12-135"><a href="#cb12-135" aria-hidden="true" tabindex="-1"></a>      donald_trump_republican,</span>
<span id="cb12-136"><a href="#cb12-136" aria-hidden="true" tabindex="-1"></a>      donald_trump_republican_2,</span>
<span id="cb12-137"><a href="#cb12-137" aria-hidden="true" tabindex="-1"></a>      kamala_harris_democratic,</span>
<span id="cb12-138"><a href="#cb12-138" aria-hidden="true" tabindex="-1"></a>      kamala_harris_democratic_2,</span>
<span id="cb12-139"><a href="#cb12-139" aria-hidden="true" tabindex="-1"></a>      various_candidates_other_parties,</span>
<span id="cb12-140"><a href="#cb12-140" aria-hidden="true" tabindex="-1"></a>      various_candidates_other_parties_2,</span>
<span id="cb12-141"><a href="#cb12-141" aria-hidden="true" tabindex="-1"></a>      margin,</span>
<span id="cb12-142"><a href="#cb12-142" aria-hidden="true" tabindex="-1"></a>      margin_2,</span>
<span id="cb12-143"><a href="#cb12-143" aria-hidden="true" tabindex="-1"></a>      total</span>
<span id="cb12-144"><a href="#cb12-144" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb12-145"><a href="#cb12-145" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span> <span class="fu">as.numeric</span>(<span class="fu">str_replace_all</span>(.x, <span class="st">"[%,]"</span>, <span class="st">""</span>))</span>
<span id="cb12-146"><a href="#cb12-146" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb12-147"><a href="#cb12-147" aria-hidden="true" tabindex="-1"></a>election_results_2024_final <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb12-148"><a href="#cb12-148" aria-hidden="true" tabindex="-1"></a>  election_results_2024_updated,</span>
<span id="cb12-149"><a href="#cb12-149" aria-hidden="true" tabindex="-1"></a>  dc_row,</span>
<span id="cb12-150"><a href="#cb12-150" aria-hidden="true" tabindex="-1"></a>  ak_row,</span>
<span id="cb12-151"><a href="#cb12-151" aria-hidden="true" tabindex="-1"></a>  wa_results</span>
<span id="cb12-152"><a href="#cb12-152" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-153"><a href="#cb12-153" aria-hidden="true" tabindex="-1"></a>election_results_2024_final <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb12-154"><a href="#cb12-154" aria-hidden="true" tabindex="-1"></a>  election_results_2024_updated,</span>
<span id="cb12-155"><a href="#cb12-155" aria-hidden="true" tabindex="-1"></a>  dc_row,</span>
<span id="cb12-156"><a href="#cb12-156" aria-hidden="true" tabindex="-1"></a>  ak_row,</span>
<span id="cb12-157"><a href="#cb12-157" aria-hidden="true" tabindex="-1"></a>  wa_results</span>
<span id="cb12-158"><a href="#cb12-158" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-159"><a href="#cb12-159" aria-hidden="true" tabindex="-1"></a>election_results_2024_final <span class="ot">&lt;-</span> election_results_2024_final <span class="sc">|&gt;</span></span>
<span id="cb12-160"><a href="#cb12-160" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(county, <span class="fu">regex</span>(<span class="st">"^county(</span><span class="sc">\\</span><span class="st">[</span><span class="sc">\\</span><span class="st">d+</span><span class="sc">\\</span><span class="st">])?$"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb12-161"><a href="#cb12-161" aria-hidden="true" tabindex="-1"></a>election_results_2024_final <span class="sc">|&gt;</span></span>
<span id="cb12-162"><a href="#cb12-162" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>) <span class="sc">|&gt;</span></span>
<span id="cb12-163"><a href="#cb12-163" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Preview of 2024 Election Results"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Preview of 2024 Election Results</caption>
<colgroup>
<col style="width: 2%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 6%">
<col style="width: 8%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">county</th>
<th style="text-align: right;">donald_trump_republican</th>
<th style="text-align: right;">donald_trump_republican_2</th>
<th style="text-align: right;">kamala_harris_democratic</th>
<th style="text-align: right;">kamala_harris_democratic_2</th>
<th style="text-align: right;">various_candidates_other_parties</th>
<th style="text-align: right;">various_candidates_other_parties_2</th>
<th style="text-align: right;">margin</th>
<th style="text-align: right;">margin_2</th>
<th style="text-align: right;">total</th>
<th style="text-align: left;">state</th>
<th style="text-align: left;">total_votes_cast</th>
<th style="text-align: right;">kamala_harris_dfl</th>
<th style="text-align: right;">kamala_harris_dfl_2</th>
<th style="text-align: left;">kamala_harris_democratic_npl</th>
<th style="text-align: right;">kamala_harris_democratic_npl_2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Autauga</td>
<td style="text-align: right;">20484</td>
<td style="text-align: right;">72.43</td>
<td style="text-align: right;">7439</td>
<td style="text-align: right;">26.30</td>
<td style="text-align: right;">358</td>
<td style="text-align: right;">1.27</td>
<td style="text-align: right;">13045</td>
<td style="text-align: right;">46.13</td>
<td style="text-align: right;">28281</td>
<td style="text-align: left;">Alabama</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Baldwin</td>
<td style="text-align: right;">95798</td>
<td style="text-align: right;">78.36</td>
<td style="text-align: right;">24934</td>
<td style="text-align: right;">20.40</td>
<td style="text-align: right;">1517</td>
<td style="text-align: right;">1.24</td>
<td style="text-align: right;">70864</td>
<td style="text-align: right;">57.96</td>
<td style="text-align: right;">122249</td>
<td style="text-align: left;">Alabama</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Barbour</td>
<td style="text-align: right;">5606</td>
<td style="text-align: right;">56.88</td>
<td style="text-align: right;">4158</td>
<td style="text-align: right;">42.19</td>
<td style="text-align: right;">91</td>
<td style="text-align: right;">0.93</td>
<td style="text-align: right;">1448</td>
<td style="text-align: right;">14.69</td>
<td style="text-align: right;">9855</td>
<td style="text-align: left;">Alabama</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bibb</td>
<td style="text-align: right;">7572</td>
<td style="text-align: right;">81.80</td>
<td style="text-align: right;">1619</td>
<td style="text-align: right;">17.49</td>
<td style="text-align: right;">66</td>
<td style="text-align: right;">0.71</td>
<td style="text-align: right;">5953</td>
<td style="text-align: right;">64.31</td>
<td style="text-align: right;">9257</td>
<td style="text-align: left;">Alabama</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Blount</td>
<td style="text-align: right;">25354</td>
<td style="text-align: right;">90.03</td>
<td style="text-align: right;">2576</td>
<td style="text-align: right;">9.15</td>
<td style="text-align: right;">233</td>
<td style="text-align: right;">0.82</td>
<td style="text-align: right;">22778</td>
<td style="text-align: right;">80.88</td>
<td style="text-align: right;">28163</td>
<td style="text-align: left;">Alabama</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bullock</td>
<td style="text-align: right;">1101</td>
<td style="text-align: right;">26.78</td>
<td style="text-align: right;">2983</td>
<td style="text-align: right;">72.56</td>
<td style="text-align: right;">27</td>
<td style="text-align: right;">0.66</td>
<td style="text-align: right;">-1882</td>
<td style="text-align: right;">-45.78</td>
<td style="text-align: right;">4111</td>
<td style="text-align: left;">Alabama</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Butler</td>
<td style="text-align: right;">5172</td>
<td style="text-align: right;">60.99</td>
<td style="text-align: right;">3251</td>
<td style="text-align: right;">38.34</td>
<td style="text-align: right;">57</td>
<td style="text-align: right;">0.67</td>
<td style="text-align: right;">1921</td>
<td style="text-align: right;">22.65</td>
<td style="text-align: right;">8480</td>
<td style="text-align: left;">Alabama</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Calhoun</td>
<td style="text-align: right;">34912</td>
<td style="text-align: right;">71.76</td>
<td style="text-align: right;">13194</td>
<td style="text-align: right;">27.12</td>
<td style="text-align: right;">547</td>
<td style="text-align: right;">1.12</td>
<td style="text-align: right;">21718</td>
<td style="text-align: right;">44.64</td>
<td style="text-align: right;">48653</td>
<td style="text-align: left;">Alabama</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Chambers</td>
<td style="text-align: right;">8711</td>
<td style="text-align: right;">61.15</td>
<td style="text-align: right;">5405</td>
<td style="text-align: right;">37.94</td>
<td style="text-align: right;">129</td>
<td style="text-align: right;">0.91</td>
<td style="text-align: right;">3306</td>
<td style="text-align: right;">23.21</td>
<td style="text-align: right;">14245</td>
<td style="text-align: left;">Alabama</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cherokee</td>
<td style="text-align: right;">11358</td>
<td style="text-align: right;">87.33</td>
<td style="text-align: right;">1553</td>
<td style="text-align: right;">11.94</td>
<td style="text-align: right;">95</td>
<td style="text-align: right;">0.73</td>
<td style="text-align: right;">9805</td>
<td style="text-align: right;">75.39</td>
<td style="text-align: right;">13006</td>
<td style="text-align: left;">Alabama</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="county-level-election-data-1" class="level5">
<h5 class="anchored" data-anchor-id="county-level-election-data-1"><span style="border-bottom: 3px solid #ccc; padding-bottom: 5px;">2020 County-Level Election Data</span></h5>
<p>For this data we will be doing the same downloading and scraping steps we did for the 2024 dataset.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(<span class="st">"data/mp04/state_pages_2020"</span>, <span class="at">showWarnings =</span> <span class="cn">FALSE</span>, <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(<span class="st">"data/mp04/state_pages_2020"</span>, <span class="at">showWarnings =</span> <span class="cn">FALSE</span>, <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>get_state_results_2020 <span class="ot">&lt;-</span> <span class="cf">function</span>(state_name) {</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  state_url <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">" "</span>, <span class="st">"_"</span>, state_name)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  url <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"https://en.wikipedia.org/wiki/2020_United_States_presidential_election_in_"</span>, state_url)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  local_file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">"data/mp04/state_pages_2020"</span>, <span class="fu">paste0</span>(state_url, <span class="st">".html"</span>))</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(local_file)) {</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tryCatch</span>({</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>      resp <span class="ot">&lt;-</span> <span class="fu">request</span>(url) <span class="sc">|&gt;</span> <span class="fu">req_perform</span>()</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">writeLines</span>(<span class="fu">resp_body_string</span>(resp), local_file)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">message</span>(<span class="st">"Failed to download: "</span>, state_name)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="cn">NULL</span>)</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>  page <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>(<span class="fu">read_html</span>(local_file), <span class="at">error =</span> <span class="cf">function</span>(e) <span class="fu">return</span>(<span class="cn">NULL</span>))</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(page)) <span class="fu">return</span>(<span class="cn">NULL</span>)</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>  tables <span class="ot">&lt;-</span> page <span class="sc">|&gt;</span> <span class="fu">html_elements</span>(<span class="st">"table"</span>) <span class="sc">|&gt;</span> <span class="fu">html_table</span>()</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>  county_table <span class="ot">&lt;-</span> tables <span class="sc">|&gt;</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">keep</span>(<span class="sc">~</span> <span class="fu">any</span>(<span class="fu">str_detect</span>(<span class="fu">tolower</span>(<span class="fu">names</span>(.x)), <span class="st">"county|parish|borough"</span>))) <span class="sc">|&gt;</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pluck</span>(<span class="dv">1</span>, <span class="at">.default =</span> <span class="cn">NULL</span>)</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(county_table)) {</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">message</span>(<span class="st">"⚠️ No county-level table for "</span>, state_name)</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">NULL</span>)</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a><span class="co">#Clean and standardize column names</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>  cleaned <span class="ot">&lt;-</span> county_table <span class="sc">|&gt;</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">clean_names</span>() <span class="sc">|&gt;</span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">state =</span> state_name)</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>  county_col <span class="ot">&lt;-</span> <span class="fu">names</span>(cleaned)[<span class="fu">str_detect</span>(<span class="fu">names</span>(cleaned), <span class="st">"county|parish|borough"</span>)][<span class="dv">1</span>]</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="st">"county"</span> <span class="sc">%in%</span> <span class="fu">names</span>(cleaned)) {</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>    cleaned <span class="ot">&lt;-</span> cleaned <span class="sc">|&gt;</span> <span class="fu">rename</span>(<span class="at">county =</span> <span class="fu">all_of</span>(county_col))</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(cleaned)</span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>state_names <span class="ot">&lt;-</span> state.name</span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>safe_results_2020 <span class="ot">&lt;-</span> <span class="fu">map</span>(state_names, <span class="fu">safely</span>(get_state_results_2020))</span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>results_2020 <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a>failures_2020 <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(state_names)) {</span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> safe_results_2020[[i]]</span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(result<span class="sc">$</span>result)) {</span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a>    failures_2020 <span class="ot">&lt;-</span> <span class="fu">c</span>(failures_2020, state_names[i])</span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a>    results_2020[[state_names[i]]] <span class="ot">&lt;-</span> result<span class="sc">$</span>result</span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a>election_results_2020_clean <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(results_2020)</span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a>election_results_2020_clean <span class="ot">&lt;-</span> election_results_2020_clean <span class="sc">|&gt;</span></span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">where</span>(<span class="sc">~</span> <span class="sc">!</span><span class="fu">all</span>(<span class="fu">is.na</span>(.)))) <span class="sc">|&gt;</span>  <span class="co"># drop all-NA columns</span></span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(county, <span class="fu">regex</span>(<span class="st">"Total|Statewide|City|#"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>))) <span class="sc">|&gt;</span></span>
<span id="cb13-58"><a href="#cb13-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.character), <span class="sc">~</span> <span class="fu">str_replace_all</span>(.x, <span class="st">"[,%]"</span>, <span class="st">""</span>)))  <span class="co"># remove commas/%</span></span>
<span id="cb13-59"><a href="#cb13-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-60"><a href="#cb13-60" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(election_results_2020_clean, <span class="st">"data/mp04/combined_2020_county_results.csv"</span>)</span>
<span id="cb13-61"><a href="#cb13-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-62"><a href="#cb13-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Check which states are missing</span></span>
<span id="cb13-63"><a href="#cb13-63" aria-hidden="true" tabindex="-1"></a>all_states <span class="ot">&lt;-</span> <span class="fu">c</span>(state.name, <span class="st">"District of Columbia"</span>)</span>
<span id="cb13-64"><a href="#cb13-64" aria-hidden="true" tabindex="-1"></a>election_results_2020_clean <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">"data/mp04/combined_2020_county_results.csv"</span>)</span>
<span id="cb13-65"><a href="#cb13-65" aria-hidden="true" tabindex="-1"></a>missing_states_2020 <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(all_states, <span class="fu">unique</span>(election_results_2020_clean<span class="sc">$</span>state))</span>
<span id="cb13-66"><a href="#cb13-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-67"><a href="#cb13-67" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Missing 2020 States:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Missing 2020 States:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(missing_states_2020)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Alaska"               "Washington"           "District of Columbia"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>get_ohio_2020_results <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  state_name <span class="ot">&lt;-</span> <span class="st">"Ohio"</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  url <span class="ot">&lt;-</span> <span class="st">"https://en.wikipedia.org/wiki/2020_United_States_presidential_election_in_Ohio"</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  file_path <span class="ot">&lt;-</span> <span class="st">"data/mp04/state_pages/Ohio_2020.html"</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(file_path)) {</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    page <span class="ot">&lt;-</span> <span class="fu">request</span>(url) <span class="sc">|&gt;</span> <span class="fu">req_perform</span>()</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">writeLines</span>(<span class="fu">resp_body_string</span>(page), file_path)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  page <span class="ot">&lt;-</span> <span class="fu">read_html</span>(file_path)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  tables <span class="ot">&lt;-</span> page <span class="sc">|&gt;</span> <span class="fu">html_elements</span>(<span class="st">"table"</span>) <span class="sc">|&gt;</span> <span class="fu">html_table</span>()</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(tables) <span class="sc">&lt;</span> <span class="dv">38</span>) {</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">message</span>(<span class="st">"Table 398not found."</span>)</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">NULL</span>)</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>  county_table <span class="ot">&lt;-</span> tables[[<span class="dv">38</span>]]</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>  cleaned <span class="ot">&lt;-</span> county_table <span class="sc">|&gt;</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">clean_names</span>() <span class="sc">|&gt;</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">county =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span>  </span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(county, <span class="fu">regex</span>(<span class="st">"total|summary"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>))) <span class="sc">|&gt;</span></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">state =</span> state_name)</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(cleaned)</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>ohio_2020_results <span class="ot">&lt;-</span> <span class="fu">get_ohio_2020_results</span>()</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a><span class="co">#alaska 2020 info</span></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>ak_2020_row <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">county =</span> <span class="st">"Statewide"</span>,</span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">donald_trump_republican =</span> <span class="dv">189951</span>,</span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">joe_biden_democratic =</span> <span class="dv">153778</span>,</span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">various_candidates_other_parties =</span> <span class="dv">14917</span>,</span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">margin =</span> <span class="dv">36173</span>,</span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">total =</span> <span class="dv">358646</span>,</span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="st">"Alaska"</span></span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a><span class="co">#washington 2020 info</span></span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>get_washington_2020_results <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>  state_name <span class="ot">&lt;-</span> <span class="st">"Washington"</span></span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>  url <span class="ot">&lt;-</span> <span class="st">"https://en.wikipedia.org/wiki/2020_United_States_presidential_election_in_Washington_(state)"</span></span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>  file_path <span class="ot">&lt;-</span> <span class="st">"data/mp04/state_pages/Washington_2020.html"</span></span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(file_path)) {</span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a>    page <span class="ot">&lt;-</span> <span class="fu">request</span>(url) <span class="sc">|&gt;</span> <span class="fu">req_perform</span>()</span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">writeLines</span>(<span class="fu">resp_body_string</span>(page), file_path)</span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a>  page <span class="ot">&lt;-</span> <span class="fu">read_html</span>(file_path)</span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a>  tables <span class="ot">&lt;-</span> page <span class="sc">|&gt;</span> <span class="fu">html_elements</span>(<span class="st">"table"</span>) <span class="sc">|&gt;</span> <span class="fu">html_table</span>()</span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a>  county_table <span class="ot">&lt;-</span> tables <span class="sc">|&gt;</span> </span>
<span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">keep</span>(<span class="sc">~</span> <span class="fu">any</span>(<span class="fu">str_detect</span>(<span class="fu">names</span>(.x), <span class="fu">regex</span>(<span class="st">"county"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>)))) <span class="sc">|&gt;</span> </span>
<span id="cb17-55"><a href="#cb17-55" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pluck</span>(<span class="dv">1</span>, <span class="at">.default =</span> <span class="cn">NULL</span>)</span>
<span id="cb17-56"><a href="#cb17-56" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-57"><a href="#cb17-57" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(county_table)) {</span>
<span id="cb17-58"><a href="#cb17-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">message</span>(<span class="st">"No Washington county-level table found."</span>)</span>
<span id="cb17-59"><a href="#cb17-59" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">NULL</span>)</span>
<span id="cb17-60"><a href="#cb17-60" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb17-61"><a href="#cb17-61" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-62"><a href="#cb17-62" aria-hidden="true" tabindex="-1"></a>  cleaned <span class="ot">&lt;-</span> county_table <span class="sc">|&gt;</span> </span>
<span id="cb17-63"><a href="#cb17-63" aria-hidden="true" tabindex="-1"></a>    <span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb17-64"><a href="#cb17-64" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">county =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb17-65"><a href="#cb17-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(county, <span class="fu">regex</span>(<span class="st">"total|summary"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb17-66"><a href="#cb17-66" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">state =</span> state_name)</span>
<span id="cb17-67"><a href="#cb17-67" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-68"><a href="#cb17-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(cleaned)</span>
<span id="cb17-69"><a href="#cb17-69" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-70"><a href="#cb17-70" aria-hidden="true" tabindex="-1"></a>wa_2020_results <span class="ot">&lt;-</span> <span class="fu">get_washington_2020_results</span>()</span>
<span id="cb17-71"><a href="#cb17-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-72"><a href="#cb17-72" aria-hidden="true" tabindex="-1"></a><span class="co">#dc 2020 info</span></span>
<span id="cb17-73"><a href="#cb17-73" aria-hidden="true" tabindex="-1"></a>dc_2020_row <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb17-74"><a href="#cb17-74" aria-hidden="true" tabindex="-1"></a>  <span class="at">county =</span> <span class="st">"District of Columbia"</span>,</span>
<span id="cb17-75"><a href="#cb17-75" aria-hidden="true" tabindex="-1"></a>  <span class="at">donald_trump_republican =</span> <span class="dv">18000</span>,</span>
<span id="cb17-76"><a href="#cb17-76" aria-hidden="true" tabindex="-1"></a>  <span class="at">donald_trump_republican_2 =</span> <span class="fl">5.4</span>,</span>
<span id="cb17-77"><a href="#cb17-77" aria-hidden="true" tabindex="-1"></a>  <span class="at">joe_biden_democratic =</span> <span class="dv">317000</span>,</span>
<span id="cb17-78"><a href="#cb17-78" aria-hidden="true" tabindex="-1"></a>  <span class="at">joe_biden_democratic_2 =</span> <span class="fl">92.1</span>,</span>
<span id="cb17-79"><a href="#cb17-79" aria-hidden="true" tabindex="-1"></a>  <span class="at">various_candidates_other_parties =</span> <span class="dv">4000</span>,</span>
<span id="cb17-80"><a href="#cb17-80" aria-hidden="true" tabindex="-1"></a>  <span class="at">various_candidates_other_parties_2 =</span> <span class="fl">2.5</span>,</span>
<span id="cb17-81"><a href="#cb17-81" aria-hidden="true" tabindex="-1"></a>  <span class="at">margin =</span> <span class="dv">299000</span>,</span>
<span id="cb17-82"><a href="#cb17-82" aria-hidden="true" tabindex="-1"></a>  <span class="at">margin_2 =</span> <span class="fl">86.7</span>,</span>
<span id="cb17-83"><a href="#cb17-83" aria-hidden="true" tabindex="-1"></a>  <span class="at">total =</span> <span class="dv">344000</span>,</span>
<span id="cb17-84"><a href="#cb17-84" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="st">"District of Columbia"</span></span>
<span id="cb17-85"><a href="#cb17-85" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-86"><a href="#cb17-86" aria-hidden="true" tabindex="-1"></a>cols_to_fix <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb17-87"><a href="#cb17-87" aria-hidden="true" tabindex="-1"></a>  <span class="st">"donald_trump_republican"</span>, <span class="st">"donald_trump_republican_2"</span>,</span>
<span id="cb17-88"><a href="#cb17-88" aria-hidden="true" tabindex="-1"></a>  <span class="st">"joe_biden_democratic"</span>, <span class="st">"joe_biden_democratic_2"</span>,</span>
<span id="cb17-89"><a href="#cb17-89" aria-hidden="true" tabindex="-1"></a>  <span class="st">"various_candidates_other_parties"</span>, <span class="st">"various_candidates_other_parties_2"</span>,</span>
<span id="cb17-90"><a href="#cb17-90" aria-hidden="true" tabindex="-1"></a>  <span class="st">"margin"</span>, <span class="st">"margin_2"</span>, <span class="st">"total"</span>,</span>
<span id="cb17-91"><a href="#cb17-91" aria-hidden="true" tabindex="-1"></a>  <span class="st">"howie_hawkins_green"</span> </span>
<span id="cb17-92"><a href="#cb17-92" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-93"><a href="#cb17-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-94"><a href="#cb17-94" aria-hidden="true" tabindex="-1"></a>fix_numeric <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb17-95"><a href="#cb17-95" aria-hidden="true" tabindex="-1"></a>  df <span class="sc">|&gt;</span></span>
<span id="cb17-96"><a href="#cb17-96" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">any_of</span>(cols_to_fix), <span class="sc">~</span> <span class="fu">as.numeric</span>(<span class="fu">str_replace_all</span>(.x, <span class="st">"[%,]"</span>, <span class="st">""</span>))))</span>
<span id="cb17-97"><a href="#cb17-97" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-98"><a href="#cb17-98" aria-hidden="true" tabindex="-1"></a><span class="co">#combining all the data</span></span>
<span id="cb17-99"><a href="#cb17-99" aria-hidden="true" tabindex="-1"></a>election_results_2020 <span class="ot">&lt;-</span> <span class="fu">fix_numeric</span>(election_results_2020_clean)</span>
<span id="cb17-100"><a href="#cb17-100" aria-hidden="true" tabindex="-1"></a>ohio_2020_results <span class="ot">&lt;-</span> <span class="fu">fix_numeric</span>(ohio_2020_results)</span>
<span id="cb17-101"><a href="#cb17-101" aria-hidden="true" tabindex="-1"></a>ak_2020_row <span class="ot">&lt;-</span> <span class="fu">fix_numeric</span>(ak_2020_row)</span>
<span id="cb17-102"><a href="#cb17-102" aria-hidden="true" tabindex="-1"></a>wa_2020_results <span class="ot">&lt;-</span> <span class="fu">fix_numeric</span>(wa_2020_results)</span>
<span id="cb17-103"><a href="#cb17-103" aria-hidden="true" tabindex="-1"></a>dc_2020_row <span class="ot">&lt;-</span> <span class="fu">fix_numeric</span>(dc_2020_row)</span>
<span id="cb17-104"><a href="#cb17-104" aria-hidden="true" tabindex="-1"></a>election_results_2020_final <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb17-105"><a href="#cb17-105" aria-hidden="true" tabindex="-1"></a>  election_results_2020,</span>
<span id="cb17-106"><a href="#cb17-106" aria-hidden="true" tabindex="-1"></a>  ohio_2020_results,</span>
<span id="cb17-107"><a href="#cb17-107" aria-hidden="true" tabindex="-1"></a>  ak_2020_row,</span>
<span id="cb17-108"><a href="#cb17-108" aria-hidden="true" tabindex="-1"></a>  wa_2020_results,</span>
<span id="cb17-109"><a href="#cb17-109" aria-hidden="true" tabindex="-1"></a>  dc_2020_row</span>
<span id="cb17-110"><a href="#cb17-110" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-111"><a href="#cb17-111" aria-hidden="true" tabindex="-1"></a>election_results_2020_final <span class="ot">&lt;-</span> election_results_2020_final <span class="sc">|&gt;</span></span>
<span id="cb17-112"><a href="#cb17-112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(county, <span class="fu">regex</span>(<span class="st">"^county(</span><span class="sc">\\</span><span class="st">[</span><span class="sc">\\</span><span class="st">d+</span><span class="sc">\\</span><span class="st">])?$"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb17-113"><a href="#cb17-113" aria-hidden="true" tabindex="-1"></a>election_results_2020_final <span class="ot">&lt;-</span> election_results_2020_final <span class="sc">|&gt;</span></span>
<span id="cb17-114"><a href="#cb17-114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">where</span>(<span class="sc">~</span> <span class="sc">!</span><span class="fu">all</span>(<span class="fu">is.na</span>(.x))))</span>
<span id="cb17-115"><a href="#cb17-115" aria-hidden="true" tabindex="-1"></a>election_results_2020_final <span class="sc">|&gt;</span></span>
<span id="cb17-116"><a href="#cb17-116" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>) <span class="sc">|&gt;</span></span>
<span id="cb17-117"><a href="#cb17-117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Preview of 2020 Election Results"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Preview of 2020 Election Results</caption>
<colgroup>
<col style="width: 1%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 6%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 5%">
<col style="width: 6%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 3%">
<col style="width: 3%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">county</th>
<th style="text-align: right;">donald_trump_republican</th>
<th style="text-align: right;">donald_trump_republican_2</th>
<th style="text-align: right;">joe_biden_democratic</th>
<th style="text-align: right;">joe_biden_democratic_2</th>
<th style="text-align: right;">various_candidates_other_parties</th>
<th style="text-align: right;">various_candidates_other_parties_2</th>
<th style="text-align: right;">margin</th>
<th style="text-align: right;">margin_2</th>
<th style="text-align: right;">total</th>
<th style="text-align: left;">state</th>
<th style="text-align: left;">total_votes_cast</th>
<th style="text-align: right;">joe_biden_dfl</th>
<th style="text-align: right;">joe_biden_dfl_2</th>
<th style="text-align: left;">candidate</th>
<th style="text-align: left;">firstalignment</th>
<th style="text-align: right;">firstalignment_2</th>
<th style="text-align: left;">finalalignment_a</th>
<th style="text-align: right;">finalalignment_a_2</th>
<th style="text-align: right;">countyconventiondelegates_b_2</th>
<th style="text-align: left;">pledgednationalconventiondelegates_c</th>
<th style="text-align: right;">joe_biden_democratic_npl</th>
<th style="text-align: right;">joe_biden_democratic_npl_2</th>
<th style="text-align: left;">jo_jorgensen_libertarian</th>
<th style="text-align: left;">jo_jorgensen_libertarian_2</th>
<th style="text-align: left;">don_blankenship_constitution</th>
<th style="text-align: right;">howie_hawkins_green</th>
<th style="text-align: left;">howie_hawkins_green_2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Autauga</td>
<td style="text-align: right;">19838</td>
<td style="text-align: right;">71.44</td>
<td style="text-align: right;">7503</td>
<td style="text-align: right;">27.02</td>
<td style="text-align: right;">429</td>
<td style="text-align: right;">1.54</td>
<td style="text-align: right;">12335</td>
<td style="text-align: right;">44.42</td>
<td style="text-align: right;">27770</td>
<td style="text-align: left;">Alabama</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Baldwin</td>
<td style="text-align: right;">83544</td>
<td style="text-align: right;">76.17</td>
<td style="text-align: right;">24578</td>
<td style="text-align: right;">22.41</td>
<td style="text-align: right;">1557</td>
<td style="text-align: right;">1.42</td>
<td style="text-align: right;">58966</td>
<td style="text-align: right;">53.76</td>
<td style="text-align: right;">109679</td>
<td style="text-align: left;">Alabama</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Barbour</td>
<td style="text-align: right;">5622</td>
<td style="text-align: right;">53.45</td>
<td style="text-align: right;">4816</td>
<td style="text-align: right;">45.79</td>
<td style="text-align: right;">80</td>
<td style="text-align: right;">0.76</td>
<td style="text-align: right;">806</td>
<td style="text-align: right;">7.66</td>
<td style="text-align: right;">10518</td>
<td style="text-align: left;">Alabama</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bibb</td>
<td style="text-align: right;">7525</td>
<td style="text-align: right;">78.43</td>
<td style="text-align: right;">1986</td>
<td style="text-align: right;">20.70</td>
<td style="text-align: right;">84</td>
<td style="text-align: right;">0.87</td>
<td style="text-align: right;">5539</td>
<td style="text-align: right;">57.73</td>
<td style="text-align: right;">9595</td>
<td style="text-align: left;">Alabama</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Blount</td>
<td style="text-align: right;">24711</td>
<td style="text-align: right;">89.57</td>
<td style="text-align: right;">2640</td>
<td style="text-align: right;">9.57</td>
<td style="text-align: right;">237</td>
<td style="text-align: right;">0.86</td>
<td style="text-align: right;">22071</td>
<td style="text-align: right;">80.00</td>
<td style="text-align: right;">27588</td>
<td style="text-align: left;">Alabama</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bullock</td>
<td style="text-align: right;">1146</td>
<td style="text-align: right;">24.84</td>
<td style="text-align: right;">3446</td>
<td style="text-align: right;">74.70</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">0.46</td>
<td style="text-align: right;">-2300</td>
<td style="text-align: right;">-49.66</td>
<td style="text-align: right;">4613</td>
<td style="text-align: left;">Alabama</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Butler</td>
<td style="text-align: right;">5458</td>
<td style="text-align: right;">57.53</td>
<td style="text-align: right;">3965</td>
<td style="text-align: right;">41.79</td>
<td style="text-align: right;">65</td>
<td style="text-align: right;">0.68</td>
<td style="text-align: right;">1493</td>
<td style="text-align: right;">15.74</td>
<td style="text-align: right;">9488</td>
<td style="text-align: left;">Alabama</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Calhoun</td>
<td style="text-align: right;">35101</td>
<td style="text-align: right;">68.85</td>
<td style="text-align: right;">15216</td>
<td style="text-align: right;">29.85</td>
<td style="text-align: right;">666</td>
<td style="text-align: right;">1.30</td>
<td style="text-align: right;">19885</td>
<td style="text-align: right;">39.00</td>
<td style="text-align: right;">50983</td>
<td style="text-align: left;">Alabama</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Chambers</td>
<td style="text-align: right;">8753</td>
<td style="text-align: right;">57.27</td>
<td style="text-align: right;">6365</td>
<td style="text-align: right;">41.64</td>
<td style="text-align: right;">166</td>
<td style="text-align: right;">1.09</td>
<td style="text-align: right;">2388</td>
<td style="text-align: right;">15.63</td>
<td style="text-align: right;">15284</td>
<td style="text-align: left;">Alabama</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cherokee</td>
<td style="text-align: right;">10583</td>
<td style="text-align: right;">86.03</td>
<td style="text-align: right;">1624</td>
<td style="text-align: right;">13.20</td>
<td style="text-align: right;">94</td>
<td style="text-align: right;">0.77</td>
<td style="text-align: right;">8959</td>
<td style="text-align: right;">72.83</td>
<td style="text-align: right;">12301</td>
<td style="text-align: left;">Alabama</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="combining-datasets" class="level5">
<h5 class="anchored" data-anchor-id="combining-datasets"><span style="border-bottom: 3px solid #ccc; padding-bottom: 5px;">Combining Datasets</span></h5>
<p>After scraping and downloading all our data, we want to combine them to and then do some initial analysis on it.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>county_shapes <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">"data/mp04/cb_2023_us_county_500k.shp"</span>) <span class="sc">|&gt;</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">fips =</span> <span class="fu">paste0</span>(STATEFP, COUNTYFP),</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">county_clean =</span> <span class="fu">tolower</span>(<span class="fu">str_replace_all</span>(NAME, <span class="st">"[^a-z]"</span>, <span class="st">""</span>)),</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">state_clean =</span> <span class="fu">case_when</span>(</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>      STATEFP <span class="sc">==</span> <span class="st">"01"</span> <span class="sc">~</span> <span class="st">"alabama"</span>,</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>      STATEFP <span class="sc">==</span> <span class="st">"02"</span> <span class="sc">~</span> <span class="st">"alaska"</span>,</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>      STATEFP <span class="sc">==</span> <span class="st">"04"</span> <span class="sc">~</span> <span class="st">"arizona"</span>,</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>      STATEFP <span class="sc">==</span> <span class="st">"05"</span> <span class="sc">~</span> <span class="st">"arkansas"</span>,</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>      STATEFP <span class="sc">==</span> <span class="st">"06"</span> <span class="sc">~</span> <span class="st">"california"</span>,</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>      STATEFP <span class="sc">==</span> <span class="st">"08"</span> <span class="sc">~</span> <span class="st">"colorado"</span>,</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>      STATEFP <span class="sc">==</span> <span class="st">"09"</span> <span class="sc">~</span> <span class="st">"connecticut"</span>,</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>      STATEFP <span class="sc">==</span> <span class="st">"10"</span> <span class="sc">~</span> <span class="st">"delaware"</span>,</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>      STATEFP <span class="sc">==</span> <span class="st">"11"</span> <span class="sc">~</span> <span class="st">"district of columbia"</span>,</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>      STATEFP <span class="sc">==</span> <span class="st">"12"</span> <span class="sc">~</span> <span class="st">"florida"</span>,</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>      STATEFP <span class="sc">==</span> <span class="st">"13"</span> <span class="sc">~</span> <span class="st">"georgia"</span>,</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>      STATEFP <span class="sc">==</span> <span class="st">"15"</span> <span class="sc">~</span> <span class="st">"hawaii"</span>,</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>      STATEFP <span class="sc">==</span> <span class="st">"16"</span> <span class="sc">~</span> <span class="st">"idaho"</span>,</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>      STATEFP <span class="sc">==</span> <span class="st">"17"</span> <span class="sc">~</span> <span class="st">"illinois"</span>,</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>      STATEFP <span class="sc">==</span> <span class="st">"18"</span> <span class="sc">~</span> <span class="st">"indiana"</span>,</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>      STATEFP <span class="sc">==</span> <span class="st">"19"</span> <span class="sc">~</span> <span class="st">"iowa"</span>,</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>      STATEFP <span class="sc">==</span> <span class="st">"20"</span> <span class="sc">~</span> <span class="st">"kansas"</span>,</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>      STATEFP <span class="sc">==</span> <span class="st">"21"</span> <span class="sc">~</span> <span class="st">"kentucky"</span>,</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>      STATEFP <span class="sc">==</span> <span class="st">"22"</span> <span class="sc">~</span> <span class="st">"louisiana"</span>,</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>      STATEFP <span class="sc">==</span> <span class="st">"23"</span> <span class="sc">~</span> <span class="st">"maine"</span>,</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>      STATEFP <span class="sc">==</span> <span class="st">"24"</span> <span class="sc">~</span> <span class="st">"maryland"</span>,</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>      STATEFP <span class="sc">==</span> <span class="st">"25"</span> <span class="sc">~</span> <span class="st">"massachusetts"</span>,</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>      STATEFP <span class="sc">==</span> <span class="st">"26"</span> <span class="sc">~</span> <span class="st">"michigan"</span>,</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>      STATEFP <span class="sc">==</span> <span class="st">"27"</span> <span class="sc">~</span> <span class="st">"minnesota"</span>,</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>      STATEFP <span class="sc">==</span> <span class="st">"28"</span> <span class="sc">~</span> <span class="st">"mississippi"</span>,</span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>      STATEFP <span class="sc">==</span> <span class="st">"29"</span> <span class="sc">~</span> <span class="st">"missouri"</span>,</span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>      STATEFP <span class="sc">==</span> <span class="st">"30"</span> <span class="sc">~</span> <span class="st">"montana"</span>,</span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>      STATEFP <span class="sc">==</span> <span class="st">"31"</span> <span class="sc">~</span> <span class="st">"nebraska"</span>,</span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>      STATEFP <span class="sc">==</span> <span class="st">"32"</span> <span class="sc">~</span> <span class="st">"nevada"</span>,</span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>      STATEFP <span class="sc">==</span> <span class="st">"33"</span> <span class="sc">~</span> <span class="st">"new hampshire"</span>,</span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>      STATEFP <span class="sc">==</span> <span class="st">"34"</span> <span class="sc">~</span> <span class="st">"new jersey"</span>,</span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a>      STATEFP <span class="sc">==</span> <span class="st">"35"</span> <span class="sc">~</span> <span class="st">"new mexico"</span>,</span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a>      STATEFP <span class="sc">==</span> <span class="st">"36"</span> <span class="sc">~</span> <span class="st">"new york"</span>,</span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a>      STATEFP <span class="sc">==</span> <span class="st">"37"</span> <span class="sc">~</span> <span class="st">"north carolina"</span>,</span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a>      STATEFP <span class="sc">==</span> <span class="st">"38"</span> <span class="sc">~</span> <span class="st">"north dakota"</span>,</span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a>      STATEFP <span class="sc">==</span> <span class="st">"39"</span> <span class="sc">~</span> <span class="st">"ohio"</span>,</span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a>      STATEFP <span class="sc">==</span> <span class="st">"40"</span> <span class="sc">~</span> <span class="st">"oklahoma"</span>,</span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a>      STATEFP <span class="sc">==</span> <span class="st">"41"</span> <span class="sc">~</span> <span class="st">"oregon"</span>,</span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a>      STATEFP <span class="sc">==</span> <span class="st">"42"</span> <span class="sc">~</span> <span class="st">"pennsylvania"</span>,</span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a>      STATEFP <span class="sc">==</span> <span class="st">"44"</span> <span class="sc">~</span> <span class="st">"rhode island"</span>,</span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a>      STATEFP <span class="sc">==</span> <span class="st">"45"</span> <span class="sc">~</span> <span class="st">"south carolina"</span>,</span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a>      STATEFP <span class="sc">==</span> <span class="st">"46"</span> <span class="sc">~</span> <span class="st">"south dakota"</span>,</span>
<span id="cb18-48"><a href="#cb18-48" aria-hidden="true" tabindex="-1"></a>      STATEFP <span class="sc">==</span> <span class="st">"47"</span> <span class="sc">~</span> <span class="st">"tennessee"</span>,</span>
<span id="cb18-49"><a href="#cb18-49" aria-hidden="true" tabindex="-1"></a>      STATEFP <span class="sc">==</span> <span class="st">"48"</span> <span class="sc">~</span> <span class="st">"texas"</span>,</span>
<span id="cb18-50"><a href="#cb18-50" aria-hidden="true" tabindex="-1"></a>      STATEFP <span class="sc">==</span> <span class="st">"49"</span> <span class="sc">~</span> <span class="st">"utah"</span>,</span>
<span id="cb18-51"><a href="#cb18-51" aria-hidden="true" tabindex="-1"></a>      STATEFP <span class="sc">==</span> <span class="st">"50"</span> <span class="sc">~</span> <span class="st">"vermont"</span>,</span>
<span id="cb18-52"><a href="#cb18-52" aria-hidden="true" tabindex="-1"></a>      STATEFP <span class="sc">==</span> <span class="st">"51"</span> <span class="sc">~</span> <span class="st">"virginia"</span>,</span>
<span id="cb18-53"><a href="#cb18-53" aria-hidden="true" tabindex="-1"></a>      STATEFP <span class="sc">==</span> <span class="st">"53"</span> <span class="sc">~</span> <span class="st">"washington"</span>,</span>
<span id="cb18-54"><a href="#cb18-54" aria-hidden="true" tabindex="-1"></a>      STATEFP <span class="sc">==</span> <span class="st">"54"</span> <span class="sc">~</span> <span class="st">"west virginia"</span>,</span>
<span id="cb18-55"><a href="#cb18-55" aria-hidden="true" tabindex="-1"></a>      STATEFP <span class="sc">==</span> <span class="st">"55"</span> <span class="sc">~</span> <span class="st">"wisconsin"</span>,</span>
<span id="cb18-56"><a href="#cb18-56" aria-hidden="true" tabindex="-1"></a>      STATEFP <span class="sc">==</span> <span class="st">"56"</span> <span class="sc">~</span> <span class="st">"wyoming"</span>,</span>
<span id="cb18-57"><a href="#cb18-57" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb18-58"><a href="#cb18-58" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb18-59"><a href="#cb18-59" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `cb_2023_us_county_500k' from data source 
  `D:\STA9750-2025-SPRING\data\mp04\cb_2023_us_county_500k.shp' 
  using driver `ESRI Shapefile'
Simple feature collection with 3235 features and 12 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: -179.1467 ymin: -14.5487 xmax: 179.7785 ymax: 71.38782
Geodetic CRS:  NAD83</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>results_2020 <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(results_2020)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare 2020 and 2024 results with clean names</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>results_2020 <span class="ot">&lt;-</span> results_2020 <span class="sc">|&gt;</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">county_clean =</span> <span class="fu">tolower</span>(<span class="fu">str_replace_all</span>(county, <span class="st">"[^a-z]"</span>, <span class="st">""</span>)),</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">state_clean =</span> <span class="fu">tolower</span>(state)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>results_2024 <span class="ot">&lt;-</span> election_results_2024_final <span class="sc">|&gt;</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">county_clean =</span> <span class="fu">tolower</span>(<span class="fu">str_replace_all</span>(county, <span class="st">"[^a-z]"</span>, <span class="st">""</span>)),</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">state_clean =</span> <span class="fu">tolower</span>(state)</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine all datasets into one spatial object</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>elections_combined <span class="ot">&lt;-</span> county_shapes <span class="sc">|&gt;</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(results_2020, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"state_clean"</span>, <span class="st">"county_clean"</span>), <span class="at">suffix =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"_2020"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(results_2024, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"state_clean"</span>, <span class="st">"county_clean"</span>), <span class="at">suffix =</span> <span class="fu">c</span>(<span class="st">"_2020"</span>, <span class="st">"_2024"</span>))</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove all-NA columns if needed</span></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>elections_combined <span class="ot">&lt;-</span> elections_combined <span class="sc">|&gt;</span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">where</span>(<span class="sc">~</span> <span class="sc">!</span><span class="fu">all</span>(<span class="fu">is.na</span>(.))))</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>elections_combined <span class="ot">&lt;-</span> elections_combined <span class="sc">|&gt;</span></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">donald_trump_republican_2024 =</span> <span class="fu">as.numeric</span>(<span class="fu">str_replace_all</span>(donald_trump_republican_2024, <span class="st">","</span>, <span class="st">""</span>)))</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>elections_combined <span class="ot">&lt;-</span> elections_combined <span class="sc">|&gt;</span></span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">joe_biden_democratic =</span> <span class="fu">as.numeric</span>(<span class="fu">str_replace_all</span>(joe_biden_democratic, <span class="st">","</span>, <span class="st">""</span>)),</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_2020 =</span> <span class="fu">as.numeric</span>(<span class="fu">str_replace_all</span>(total_2020, <span class="st">","</span>, <span class="st">""</span>))</span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>elections_combined <span class="ot">&lt;-</span> elections_combined <span class="sc">|&gt;</span></span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">donald_trump_republican_2020 =</span> <span class="fu">as.numeric</span>(<span class="fu">str_replace_all</span>(donald_trump_republican_2020, <span class="st">","</span>, <span class="st">""</span>)),</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">donald_trump_republican_2024 =</span> <span class="fu">as.numeric</span>(<span class="fu">str_replace_all</span>(donald_trump_republican_2024, <span class="st">","</span>, <span class="st">""</span>))</span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>elections_combined <span class="ot">&lt;-</span> elections_combined <span class="sc">|&gt;</span></span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_2020 =</span> <span class="fu">as.numeric</span>(<span class="fu">str_replace_all</span>(total_2020, <span class="st">","</span>, <span class="st">""</span>)),</span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_2024 =</span> <span class="fu">as.numeric</span>(<span class="fu">str_replace_all</span>(total_2024, <span class="st">","</span>, <span class="st">""</span>))</span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a>elections_combined <span class="ot">&lt;-</span> elections_combined <span class="sc">|&gt;</span></span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_2020 =</span> <span class="fu">as.numeric</span>(<span class="fu">str_replace_all</span>(<span class="fu">as.character</span>(total_2020), <span class="st">","</span>, <span class="st">""</span>)),</span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_2024 =</span> <span class="fu">as.numeric</span>(<span class="fu">str_replace_all</span>(<span class="fu">as.character</span>(total_2024), <span class="st">","</span>, <span class="st">""</span>))</span>
<span id="cb20-45"><a href="#cb20-45" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb20-46"><a href="#cb20-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-47"><a href="#cb20-47" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(elections_combined)</span>
<span id="cb20-48"><a href="#cb20-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-49"><a href="#cb20-49" aria-hidden="true" tabindex="-1"></a>elections_combined <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"elections_combined.csv"</span>)</span>
<span id="cb20-50"><a href="#cb20-50" aria-hidden="true" tabindex="-1"></a>elections_combined <span class="ot">&lt;-</span> elections_combined <span class="sc">|&gt;</span></span>
<span id="cb20-51"><a href="#cb20-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb20-52"><a href="#cb20-52" aria-hidden="true" tabindex="-1"></a>    county_shapes <span class="sc">|&gt;</span> </span>
<span id="cb20-53"><a href="#cb20-53" aria-hidden="true" tabindex="-1"></a>      <span class="fu">st_drop_geometry</span>() <span class="sc">|&gt;</span> </span>
<span id="cb20-54"><a href="#cb20-54" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(fips, ALAND, AWATER),</span>
<span id="cb20-55"><a href="#cb20-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="st">"fips"</span></span>
<span id="cb20-56"><a href="#cb20-56" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb20-57"><a href="#cb20-57" aria-hidden="true" tabindex="-1"></a>elections_combined <span class="ot">&lt;-</span> elections_combined <span class="sc">|&gt;</span></span>
<span id="cb20-58"><a href="#cb20-58" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>() <span class="sc">|&gt;</span></span>
<span id="cb20-59"><a href="#cb20-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb20-60"><a href="#cb20-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">county =</span> name,            </span>
<span id="cb20-61"><a href="#cb20-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">statefp =</span> statefp,       </span>
<span id="cb20-62"><a href="#cb20-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">state =</span> state_clean,    </span>
<span id="cb20-63"><a href="#cb20-63" aria-hidden="true" tabindex="-1"></a>    donald_trump_republican_2020,</span>
<span id="cb20-64"><a href="#cb20-64" aria-hidden="true" tabindex="-1"></a>    joe_biden_democratic,</span>
<span id="cb20-65"><a href="#cb20-65" aria-hidden="true" tabindex="-1"></a>    total_2020,</span>
<span id="cb20-66"><a href="#cb20-66" aria-hidden="true" tabindex="-1"></a>    donald_trump_republican_2024,</span>
<span id="cb20-67"><a href="#cb20-67" aria-hidden="true" tabindex="-1"></a>    kamala_harris_democratic,</span>
<span id="cb20-68"><a href="#cb20-68" aria-hidden="true" tabindex="-1"></a>    total_2024,</span>
<span id="cb20-69"><a href="#cb20-69" aria-hidden="true" tabindex="-1"></a>    geometry,</span>
<span id="cb20-70"><a href="#cb20-70" aria-hidden="true" tabindex="-1"></a>    aland,                    </span>
<span id="cb20-71"><a href="#cb20-71" aria-hidden="true" tabindex="-1"></a>    awater,</span>
<span id="cb20-72"><a href="#cb20-72" aria-hidden="true" tabindex="-1"></a>    fips</span>
<span id="cb20-73"><a href="#cb20-73" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb20-74"><a href="#cb20-74" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(elections_combined)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 3,267
Columns: 13
$ county                       &lt;chr&gt; "Baldwin", "Houston", "Barbour", "Sumter"…
$ statefp                      &lt;chr&gt; "01", "01", "01", "01", "05", "05", "05",…
$ state                        &lt;chr&gt; "alabama", "alabama", "alabama", "alabama…
$ donald_trump_republican_2020 &lt;dbl&gt; 83544, 32618, 5622, 1598, 11920, 3884, 72…
$ joe_biden_democratic         &lt;dbl&gt; 24578, 12917, 4816, 4648, 4245, 1116, 455…
$ total_2020                   &lt;dbl&gt; 109679, 46173, 10518, 6291, 16529, 5202, …
$ donald_trump_republican_2024 &lt;dbl&gt; 95798, 32469, 5606, 1542, 11842, 3772, 69…
$ kamala_harris_democratic     &lt;dbl&gt; 24934, 11352, 4158, 3725, 3769, 862, 3574…
$ total_2024                   &lt;dbl&gt; 122249, 44349, 9855, 5307, 15803, 4714, 1…
$ geometry                     &lt;chr&gt; "list(list(c(-88.02858, -88.023991, -88.0…
$ aland                        &lt;dbl&gt; 4117725048, 1501742235, 2292160151, 23408…
$ awater                       &lt;dbl&gt; 1132887203, 4795415, 50523213, 24634880, …
$ fips                         &lt;chr&gt; "01003", "01069", "01005", "01119", "0509…</code></pre>
</div>
</div>
</section>
</section>
<section id="initial-analysis" class="level2">
<h2 class="anchored" data-anchor-id="initial-analysis"><span style="border-bottom: 3px solid #ccc; padding-bottom: 5px;">Initial Analysis</span></h2>
<p>Now, we will do some initial analysis of questions we wanted to answer from the data we gathered.<br>
<strong>1. Which county or counties cast the most votes for Trump (in absolute terms) in 2024?</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>elections_combined <span class="sc">|&gt;</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(donald_trump_republican_2024)) <span class="sc">|&gt;</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(donald_trump_republican_2024, <span class="at">n =</span> <span class="dv">5</span>) <span class="sc">|&gt;</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(state, county, donald_trump_republican_2024) <span class="sc">|&gt;</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Top 5 Counties by Trump Votes in 2024"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Top 5 Counties by Trump Votes in 2024</caption>
<thead>
<tr class="header">
<th style="text-align: left;">state</th>
<th style="text-align: left;">county</th>
<th style="text-align: right;">donald_trump_republican_2024</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">california</td>
<td style="text-align: left;">Los Angeles</td>
<td style="text-align: right;">1189862</td>
</tr>
<tr class="even">
<td style="text-align: left;">texas</td>
<td style="text-align: left;">Harris</td>
<td style="text-align: right;">722695</td>
</tr>
<tr class="odd">
<td style="text-align: left;">california</td>
<td style="text-align: left;">Orange</td>
<td style="text-align: right;">654815</td>
</tr>
<tr class="even">
<td style="text-align: left;">california</td>
<td style="text-align: left;">San Diego</td>
<td style="text-align: right;">593270</td>
</tr>
<tr class="odd">
<td style="text-align: left;">california</td>
<td style="text-align: left;">Riverside</td>
<td style="text-align: right;">463677</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>2. Which county or counties cast the most votes for Biden (as a fraction of total votes cast) in 2020?</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>elections_combined <span class="sc">|&gt;</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(joe_biden_democratic), <span class="sc">!</span><span class="fu">is.na</span>(total_2020)) <span class="sc">|&gt;</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">biden_pct_2020 =</span> joe_biden_democratic <span class="sc">/</span> total_2020) <span class="sc">|&gt;</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(biden_pct_2020, <span class="at">n =</span> <span class="dv">5</span>) <span class="sc">|&gt;</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(state, county, biden_pct_2020) <span class="sc">|&gt;</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Top 5 Counties by Biden's 2020 Vote Share"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Top 5 Counties by Biden’s 2020 Vote Share</caption>
<thead>
<tr class="header">
<th style="text-align: left;">state</th>
<th style="text-align: left;">county</th>
<th style="text-align: right;">biden_pct_2020</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">california</td>
<td style="text-align: left;">San Francisco</td>
<td style="text-align: right;">0.8525610</td>
</tr>
<tr class="even">
<td style="text-align: left;">mississippi</td>
<td style="text-align: left;">Jefferson</td>
<td style="text-align: right;">0.8513306</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mississippi</td>
<td style="text-align: left;">Claiborne</td>
<td style="text-align: right;">0.8478310</td>
</tr>
<tr class="even">
<td style="text-align: left;">california</td>
<td style="text-align: left;">Marin</td>
<td style="text-align: right;">0.8232561</td>
</tr>
<tr class="odd">
<td style="text-align: left;">alabama</td>
<td style="text-align: left;">Macon</td>
<td style="text-align: right;">0.8148573</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>3.County with largest shift towards Trump (absolute increase in votes)</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>elections_combined <span class="sc">|&gt;</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(donald_trump_republican_2020), <span class="sc">!</span><span class="fu">is.na</span>(donald_trump_republican_2024)) <span class="sc">|&gt;</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trump_vote_change =</span> donald_trump_republican_2024 <span class="sc">-</span> donald_trump_republican_2020) <span class="sc">|&gt;</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(trump_vote_change, <span class="at">n =</span> <span class="dv">5</span>) <span class="sc">|&gt;</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(state, county, trump_vote_change) <span class="sc">|&gt;</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Top 5 Counties by Increase in Trump Votes from 2020 to 2024"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Top 5 Counties by Increase in Trump Votes from 2020 to 2024</caption>
<thead>
<tr class="header">
<th style="text-align: left;">state</th>
<th style="text-align: left;">county</th>
<th style="text-align: right;">trump_vote_change</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">california</td>
<td style="text-align: left;">Los Angeles</td>
<td style="text-align: right;">44332</td>
</tr>
<tr class="even">
<td style="text-align: left;">texas</td>
<td style="text-align: left;">Baylor</td>
<td style="text-align: right;">39704</td>
</tr>
<tr class="odd">
<td style="text-align: left;">texas</td>
<td style="text-align: left;">Taylor</td>
<td style="text-align: right;">39704</td>
</tr>
<tr class="even">
<td style="text-align: left;">texas</td>
<td style="text-align: left;">Bexar</td>
<td style="text-align: right;">28927</td>
</tr>
<tr class="odd">
<td style="text-align: left;">texas</td>
<td style="text-align: left;">Montgomery</td>
<td style="text-align: right;">28582</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>4. Which state had the largest shift towards Harris (or smallest shift towards Trump) in 2024? (Note that the total votes for a state can be obtained by summing all counties in that state.)</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>elections_combined <span class="sc">|&gt;</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(donald_trump_republican_2020), <span class="sc">!</span><span class="fu">is.na</span>(donald_trump_republican_2024)) <span class="sc">|&gt;</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(state) <span class="sc">|&gt;</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">trump_2020 =</span> <span class="fu">sum</span>(donald_trump_republican_2020, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">trump_2024 =</span> <span class="fu">sum</span>(donald_trump_republican_2024, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trump_shift =</span> trump_2024 <span class="sc">-</span> trump_2020) <span class="sc">|&gt;</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_min</span>(trump_shift, <span class="at">n =</span> <span class="dv">5</span>) <span class="sc">|&gt;</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Top 5 States by Largest Decrease in Trump Votes from 2020 to 2024"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Top 5 States by Largest Decrease in Trump Votes from 2020 to 2024</caption>
<thead>
<tr class="header">
<th style="text-align: left;">state</th>
<th style="text-align: right;">trump_2020</th>
<th style="text-align: right;">trump_2024</th>
<th style="text-align: right;">trump_shift</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">oregon</td>
<td style="text-align: right;">958448</td>
<td style="text-align: right;">919480</td>
<td style="text-align: right;">-38968</td>
</tr>
<tr class="even">
<td style="text-align: left;">indiana</td>
<td style="text-align: right;">1729863</td>
<td style="text-align: right;">1720347</td>
<td style="text-align: right;">-9516</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mississippi</td>
<td style="text-align: right;">756764</td>
<td style="text-align: right;">747744</td>
<td style="text-align: right;">-9020</td>
</tr>
<tr class="even">
<td style="text-align: left;">hawaii</td>
<td style="text-align: right;">196865</td>
<td style="text-align: right;">193664</td>
<td style="text-align: right;">-3201</td>
</tr>
<tr class="odd">
<td style="text-align: left;">arkansas</td>
<td style="text-align: right;">760647</td>
<td style="text-align: right;">759241</td>
<td style="text-align: right;">-1406</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>5. What is the largest county, by area, in this data set?</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>elections_combined <span class="sc">|&gt;</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(aland)) <span class="sc">|&gt;</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(aland, <span class="at">n =</span> <span class="dv">5</span>) <span class="sc">|&gt;</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(county, state, aland) <span class="sc">|&gt;</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Top 5 Largest Counties by Area (ALAND)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Top 5 Largest Counties by Area (ALAND)</caption>
<thead>
<tr class="header">
<th style="text-align: left;">county</th>
<th style="text-align: left;">state</th>
<th style="text-align: right;">aland</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Yukon-Koyukuk</td>
<td style="text-align: left;">alaska</td>
<td style="text-align: right;">377055293513</td>
</tr>
<tr class="even">
<td style="text-align: left;">North Slope</td>
<td style="text-align: left;">alaska</td>
<td style="text-align: right;">230052121425</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bethel</td>
<td style="text-align: left;">alaska</td>
<td style="text-align: right;">105253430580</td>
</tr>
<tr class="even">
<td style="text-align: left;">Northwest Arctic</td>
<td style="text-align: left;">alaska</td>
<td style="text-align: right;">92367472818</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Southeast Fairbanks</td>
<td style="text-align: left;">alaska</td>
<td style="text-align: right;">64315282486</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>6. Which county has the highest voter density (voters per unit of area) in 2020?</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>elections_combined <span class="sc">|&gt;</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(total_2020), <span class="sc">!</span><span class="fu">is.na</span>(aland), aland <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">voter_density_2020 =</span> total_2020 <span class="sc">/</span> aland) <span class="sc">|&gt;</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(voter_density_2020, <span class="at">n =</span> <span class="dv">5</span>) <span class="sc">|&gt;</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(county, state, voter_density_2020) <span class="sc">|&gt;</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Top 5 Counties by Voter Density in 2020 (Votes per Sq. Meter)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Top 5 Counties by Voter Density in 2020 (Votes per Sq. Meter)</caption>
<thead>
<tr class="header">
<th style="text-align: left;">county</th>
<th style="text-align: left;">state</th>
<th style="text-align: right;">voter_density_2020</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">San Francisco</td>
<td style="text-align: left;">california</td>
<td style="text-align: right;">0.0036672</td>
</tr>
<tr class="even">
<td style="text-align: left;">St.&nbsp;Louis</td>
<td style="text-align: left;">missouri</td>
<td style="text-align: right;">0.0033559</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Orange</td>
<td style="text-align: left;">california</td>
<td style="text-align: right;">0.0007412</td>
</tr>
<tr class="even">
<td style="text-align: left;">Dallas</td>
<td style="text-align: left;">texas</td>
<td style="text-align: right;">0.0004079</td>
</tr>
<tr class="odd">
<td style="text-align: left;">St.&nbsp;Louis</td>
<td style="text-align: left;">missouri</td>
<td style="text-align: right;">0.0004077</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>7. Which county had the largest increase in voter turnout in 2024?</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>elections_combined <span class="sc">|&gt;</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(total_2020), <span class="sc">!</span><span class="fu">is.na</span>(total_2024)) <span class="sc">|&gt;</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">turnout_increase =</span> total_2024 <span class="sc">-</span> total_2020) <span class="sc">|&gt;</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(turnout_increase)) <span class="sc">|&gt;</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(county, state, total_2020, total_2024, turnout_increase) <span class="sc">|&gt;</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">5</span>) <span class="sc">|&gt;</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Top 5 Counties by Increase in Voter Turnout from 2020 to 2024"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Top 5 Counties by Increase in Voter Turnout from 2020 to 2024</caption>
<thead>
<tr class="header">
<th style="text-align: left;">county</th>
<th style="text-align: left;">state</th>
<th style="text-align: right;">total_2020</th>
<th style="text-align: right;">total_2024</th>
<th style="text-align: right;">turnout_increase</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Baylor</td>
<td style="text-align: left;">texas</td>
<td style="text-align: right;">1702</td>
<td style="text-align: right;">55417</td>
<td style="text-align: right;">53715</td>
</tr>
<tr class="even">
<td style="text-align: left;">Taylor</td>
<td style="text-align: left;">texas</td>
<td style="text-align: right;">1702</td>
<td style="text-align: right;">55417</td>
<td style="text-align: right;">53715</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Warren</td>
<td style="text-align: left;">kentucky</td>
<td style="text-align: right;">20064</td>
<td style="text-align: right;">56891</td>
<td style="text-align: right;">36827</td>
</tr>
<tr class="even">
<td style="text-align: left;">Barren</td>
<td style="text-align: left;">kentucky</td>
<td style="text-align: right;">20064</td>
<td style="text-align: right;">56891</td>
<td style="text-align: right;">36827</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Montgomery</td>
<td style="text-align: left;">texas</td>
<td style="text-align: right;">271543</td>
<td style="text-align: right;">307258</td>
<td style="text-align: right;">35715</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="electorial-shift-from-2020-to-2024" class="level2">
<h2 class="anchored" data-anchor-id="electorial-shift-from-2020-to-2024"><span style="border-bottom: 3px solid #ccc; padding-bottom: 5px;">Electorial Shift from 2020 to 2024</span></h2>
<p>We created a graph of the United States that how to see the political shift from the 2020 election to the 2024 election.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">exists</span>(<span class="st">"elections_combined"</span>)) {</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  elections_combined <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/mp04/elections_combined.csv"</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>election_shifts <span class="ot">&lt;-</span> elections_combined <span class="sc">|&gt;</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">trump_pct_2020 =</span> donald_trump_republican_2020 <span class="sc">/</span> total_2020,</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">biden_pct_2020 =</span> joe_biden_democratic <span class="sc">/</span> total_2020,</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">trump_pct_2024 =</span> donald_trump_republican_2024 <span class="sc">/</span> total_2024,</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">harris_pct_2024 =</span> kamala_harris_democratic <span class="sc">/</span> total_2024,</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">margin_2020 =</span> trump_pct_2020 <span class="sc">-</span> biden_pct_2020,</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">margin_2024 =</span> trump_pct_2024 <span class="sc">-</span> harris_pct_2024,</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">margin_shift =</span> margin_2024 <span class="sc">-</span> margin_2020,</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">margin_shift_pct =</span> margin_shift <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(margin_shift))</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">exists</span>(<span class="st">"county_shapes"</span>)) {</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>  county_shapes <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">"data/mp04/cb_2023_us_county_500k.shp"</span>)</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>county_shapes <span class="ot">&lt;-</span> county_shapes <span class="sc">|&gt;</span></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fips =</span> <span class="fu">paste0</span>(STATEFP, COUNTYFP))</span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>counties_with_shifts <span class="ot">&lt;-</span> county_shapes <span class="sc">|&gt;</span></span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(election_shifts <span class="sc">|&gt;</span></span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>              <span class="fu">select</span>(fips, margin_shift, margin_shift_pct),</span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="st">"fips"</span>)</span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a>states <span class="ot">&lt;-</span> counties_with_shifts <span class="sc">|&gt;</span></span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(STATEFP) <span class="sc">|&gt;</span></span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">geometry =</span> <span class="fu">st_union</span>(geometry), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>()</span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a>move_ak <span class="ot">&lt;-</span> <span class="cf">function</span>(geom) {</span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a>  geom_scaled <span class="ot">&lt;-</span> (geom <span class="sc">-</span> <span class="fu">st_centroid</span>(geom)) <span class="sc">*</span> <span class="fl">0.4</span>  <span class="co"># scale around centroid</span></span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a>  geom_shifted <span class="ot">&lt;-</span> geom_scaled <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2500000</span>, <span class="sc">-</span><span class="dv">1300000</span>)</span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(geom_shifted)</span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-42"><a href="#cb29-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-43"><a href="#cb29-43" aria-hidden="true" tabindex="-1"></a>move_hi <span class="ot">&lt;-</span> <span class="cf">function</span>(geom) {</span>
<span id="cb29-44"><a href="#cb29-44" aria-hidden="true" tabindex="-1"></a>  geom_shifted <span class="ot">&lt;-</span> geom <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1000000</span>, <span class="sc">-</span><span class="dv">1400000</span>)</span>
<span id="cb29-45"><a href="#cb29-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(geom_shifted)</span>
<span id="cb29-46"><a href="#cb29-46" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-47"><a href="#cb29-47" aria-hidden="true" tabindex="-1"></a>states_transformed <span class="ot">&lt;-</span> states <span class="sc">|&gt;</span></span>
<span id="cb29-48"><a href="#cb29-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="dv">5070</span>)</span>
<span id="cb29-49"><a href="#cb29-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-50"><a href="#cb29-50" aria-hidden="true" tabindex="-1"></a>states_transformed<span class="sc">$</span>geometry[states_transformed<span class="sc">$</span>STATEFP <span class="sc">==</span> <span class="st">"02"</span>] <span class="ot">&lt;-</span> <span class="fu">move_ak</span>(states_transformed<span class="sc">$</span>geometry[states_transformed<span class="sc">$</span>STATEFP <span class="sc">==</span> <span class="st">"02"</span>])</span>
<span id="cb29-51"><a href="#cb29-51" aria-hidden="true" tabindex="-1"></a>states_transformed<span class="sc">$</span>geometry[states_transformed<span class="sc">$</span>STATEFP <span class="sc">==</span> <span class="st">"15"</span>] <span class="ot">&lt;-</span> <span class="fu">move_hi</span>(states_transformed<span class="sc">$</span>geometry[states_transformed<span class="sc">$</span>STATEFP <span class="sc">==</span> <span class="st">"15"</span>])</span>
<span id="cb29-52"><a href="#cb29-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-53"><a href="#cb29-53" aria-hidden="true" tabindex="-1"></a>counties_transformed <span class="ot">&lt;-</span> counties_with_shifts <span class="sc">|&gt;</span></span>
<span id="cb29-54"><a href="#cb29-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="dv">5070</span>)</span>
<span id="cb29-55"><a href="#cb29-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-56"><a href="#cb29-56" aria-hidden="true" tabindex="-1"></a>counties_transformed<span class="sc">$</span>geometry[counties_transformed<span class="sc">$</span>STATEFP <span class="sc">==</span> <span class="st">"02"</span>] <span class="ot">&lt;-</span> <span class="fu">move_ak</span>(counties_transformed<span class="sc">$</span>geometry[counties_transformed<span class="sc">$</span>STATEFP <span class="sc">==</span> <span class="st">"02"</span>])</span>
<span id="cb29-57"><a href="#cb29-57" aria-hidden="true" tabindex="-1"></a>counties_transformed<span class="sc">$</span>geometry[counties_transformed<span class="sc">$</span>STATEFP <span class="sc">==</span> <span class="st">"15"</span>] <span class="ot">&lt;-</span> <span class="fu">move_hi</span>(counties_transformed<span class="sc">$</span>geometry[counties_transformed<span class="sc">$</span>STATEFP <span class="sc">==</span> <span class="st">"15"</span>])</span>
<span id="cb29-58"><a href="#cb29-58" aria-hidden="true" tabindex="-1"></a>arrow_scale <span class="ot">&lt;-</span> <span class="dv">20000</span></span>
<span id="cb29-59"><a href="#cb29-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-60"><a href="#cb29-60" aria-hidden="true" tabindex="-1"></a>counties_arrows <span class="ot">&lt;-</span> counties_transformed <span class="sc">|&gt;</span></span>
<span id="cb29-61"><a href="#cb29-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(margin_shift)) <span class="sc">|&gt;</span></span>
<span id="cb29-62"><a href="#cb29-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb29-63"><a href="#cb29-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">centroid =</span> <span class="fu">st_centroid</span>(geometry),</span>
<span id="cb29-64"><a href="#cb29-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">st_coordinates</span>(centroid)[, <span class="dv">1</span>],</span>
<span id="cb29-65"><a href="#cb29-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">st_coordinates</span>(centroid)[, <span class="dv">2</span>],</span>
<span id="cb29-66"><a href="#cb29-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">angle =</span> <span class="fu">if_else</span>(margin_shift <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="dv">0</span>, pi),</span>
<span id="cb29-67"><a href="#cb29-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">length =</span> <span class="fu">abs</span>(margin_shift) <span class="sc">*</span> arrow_scale,</span>
<span id="cb29-68"><a href="#cb29-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">x_end =</span> x <span class="sc">+</span> <span class="fu">cos</span>(angle) <span class="sc">*</span> length,</span>
<span id="cb29-69"><a href="#cb29-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">y_end =</span> y <span class="sc">+</span> <span class="fu">sin</span>(angle) <span class="sc">*</span> length</span>
<span id="cb29-70"><a href="#cb29-70" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb29-71"><a href="#cb29-71" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb29-72"><a href="#cb29-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> states_transformed, <span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">color =</span> <span class="st">"gray70"</span>, <span class="at">size =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb29-73"><a href="#cb29-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb29-74"><a href="#cb29-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> counties_arrows,</span>
<span id="cb29-75"><a href="#cb29-75" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">xend =</span> x_end, <span class="at">yend =</span> y_end, <span class="at">color =</span> margin_shift <span class="sc">&gt;</span> <span class="dv">0</span>),</span>
<span id="cb29-76"><a href="#cb29-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>, <span class="st">"cm"</span>)),</span>
<span id="cb29-77"><a href="#cb29-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">0.3</span>,</span>
<span id="cb29-78"><a href="#cb29-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.8</span></span>
<span id="cb29-79"><a href="#cb29-79" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb29-80"><a href="#cb29-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb29-81"><a href="#cb29-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"TRUE"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"FALSE"</span> <span class="ot">=</span> <span class="st">"blue"</span>),</span>
<span id="cb29-82"><a href="#cb29-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"TRUE"</span> <span class="ot">=</span> <span class="st">"More Rep."</span>, <span class="st">"FALSE"</span> <span class="ot">=</span> <span class="st">"More Dem."</span>),</span>
<span id="cb29-83"><a href="#cb29-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Shift from 2020 to 2024"</span></span>
<span id="cb29-84"><a href="#cb29-84" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb29-85"><a href="#cb29-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb29-86"><a href="#cb29-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb29-87"><a href="#cb29-87" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb29-88"><a href="#cb29-88" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb29-89"><a href="#cb29-89" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb29-90"><a href="#cb29-90" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb29-91"><a href="#cb29-91" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb29-92"><a href="#cb29-92" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.direction =</span> <span class="st">"horizontal"</span></span>
<span id="cb29-93"><a href="#cb29-93" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb29-94"><a href="#cb29-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb29-95"><a href="#cb29-95" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"County-Level Shift in Vote Margin: 2020 → 2024"</span>,</span>
<span id="cb29-96"><a href="#cb29-96" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Data: Wikipedia county election results"</span></span>
<span id="cb29-97"><a href="#cb29-97" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb29-98"><a href="#cb29-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_sf</span>(</span>
<span id="cb29-99"><a href="#cb29-99" aria-hidden="true" tabindex="-1"></a>    <span class="at">crs =</span> <span class="fu">st_crs</span>(counties_transformed),</span>
<span id="cb29-100"><a href="#cb29-100" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2500000</span>, <span class="dv">2500000</span>),  <span class="co"># tweak these numbers</span></span>
<span id="cb29-101"><a href="#cb29-101" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1000000</span>, <span class="dv">3500000</span>),  <span class="co"># tweak these numbers</span></span>
<span id="cb29-102"><a href="#cb29-102" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="cn">FALSE</span></span>
<span id="cb29-103"><a href="#cb29-103" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp04_files/figure-html/shift-map-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"nyt_county_shift_map_large.png"</span>, <span class="at">width =</span> <span class="dv">18</span>, <span class="at">height =</span> <span class="dv">11</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/wowlime\.github\.io\/STA9750-2025-SPRING\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>